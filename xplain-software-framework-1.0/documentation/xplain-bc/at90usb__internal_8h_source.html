<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>xplain-bc: drivers/usb/at90usb/at90usb_internal.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>drivers/usb/at90usb/at90usb_internal.h</h1><a href="at90usb__internal_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00042"></a>00042 <span class="preprocessor">#ifndef AT90USB_INTERNAL_H_INCLUDED</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">#define AT90USB_INTERNAL_H_INCLUDED</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="slist_8h.html" title="Singly linked list implementation.">slist.h</a>&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="arch_2avr8_2include_2arch_2bitops_8h.html" title="AVR-specific implementation of bit operations.">bitops.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="arch_2avr8_2include_2arch_2stdint_8h.html" title="C99 integer type definitions for AVR.">stdint.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="workqueue_8h.html" title="Workqueue interface.">workqueue.h</a>&gt;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;<a class="code" href="udc_8h.html" title="USB Device Controller interface.">usb/udc.h</a>&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;<a class="code" href="request_8h.html" title="USB request structure and associated helper functions.">usb/request.h</a>&gt;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;<a class="code" href="chip_2at90usb1287_2include_2chip_2regs_8h.html" title="Register definitions for the AT90USB1287.">chip/regs.h</a>&gt;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="at90usb__regs_8h.html" title="AT90USB USB register definitions.">at90usb_regs.h</a>&quot;</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">/* USB Device Controller part */</span>
<a name="l00058"></a>00058 
<a name="l00062"></a><a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6">00062</a> <span class="keyword">enum</span> <a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6">ep0_state</a> {
<a name="l00063"></a><a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6aba5b38ca0139d301b1a47028bc57d4e5">00063</a>         <a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6aba5b38ca0139d301b1a47028bc57d4e5">EP0_STATE_SETUP</a> = 0,  
<a name="l00064"></a><a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6adb6fc1382202f7a3e1b96f15b853aedd">00064</a>         <a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6adb6fc1382202f7a3e1b96f15b853aedd">EP0_STATE_DATA_IN</a>,    
<a name="l00065"></a><a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6a0b45fb286c74602982b30fdb57890746">00065</a>         <a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6a0b45fb286c74602982b30fdb57890746">EP0_STATE_DATA_ZLP</a>,   
<a name="l00066"></a><a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6ac53aee127db98d2c8a8f2d29d66853e0">00066</a>         <a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6ac53aee127db98d2c8a8f2d29d66853e0">EP0_STATE_DATA_OUT</a>,   
<a name="l00067"></a><a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6aa4ac8ee92d6942979d445c9b06cbfedb">00067</a>         <a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6aa4ac8ee92d6942979d445c9b06cbfedb">EP0_STATE_STATUS_IN</a>,  
<a name="l00068"></a><a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6a3a25cb07a09c6f734f5701ee03979fa5">00068</a>         <a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6a3a25cb07a09c6f734f5701ee03979fa5">EP0_STATE_STATUS_OUT</a>, 
<a name="l00069"></a>00069 };
<a name="l00070"></a>00070 
<a name="l00074"></a><a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80">00074</a> <span class="keyword">enum</span> <a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80">at90usb_ep_flag</a> {
<a name="l00075"></a><a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80a736e1de4e1becb82e29075832533f1d0">00075</a>         <a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80a736e1de4e1becb82e29075832533f1d0">AT90USB_EP_ALLOCATED</a>,   
<a name="l00076"></a><a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80a8528c4bb7a938437505122ee165d4210">00076</a>         <a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80a8528c4bb7a938437505122ee165d4210">AT90USB_EP_ACTIVE_XFER</a>, 
<a name="l00077"></a><a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80a872963ca8429a9f001f9379c8e38fb52">00077</a>         <a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80a872963ca8429a9f001f9379c8e38fb52">AT90USB_EP_ENABLED</a>,     
<a name="l00078"></a><a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80ab09e1f08b099f87d92858d893f73f07a">00078</a>         <a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80ab09e1f08b099f87d92858d893f73f07a">AT90USB_EP_IS_IN</a>,       
<a name="l00079"></a><a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80a55f7f9ecc2954b1a77a569081b7adec1">00079</a>         <a class="code" href="at90usb__internal_8h.html#a079be58ad467a2f5cb66976b2acc2d80a55f7f9ecc2954b1a77a569081b7adec1">AT90USB_EP_WEDGE</a>,       
<a name="l00080"></a>00080 };
<a name="l00081"></a>00081 
<a name="l00085"></a><a class="code" href="structat90usb__udc__ep.html">00085</a> <span class="keyword">struct </span><a class="code" href="structat90usb__udc__ep.html">at90usb_udc_ep</a> {
<a name="l00087"></a><a class="code" href="structat90usb__udc__ep.html#a7f2da754211df207fa6f34209c5139ca">00087</a>         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a>               <a class="code" href="structat90usb__udc__ep.html#a7f2da754211df207fa6f34209c5139ca" title="Shadow variable of the EP UEIENX register.">ueienx</a>;
<a name="l00089"></a><a class="code" href="structat90usb__udc__ep.html#aa8b4990ab7386f7592323972482d651e">00089</a>         <a class="code" href="group__udc__group.html#gaece2b19e35a4a25398b7e8a9f81f9d28" title="Endpoint identifier.">usb_ep_id_t</a>           <a class="code" href="structat90usb__udc__ep.html#aa8b4990ab7386f7592323972482d651e" title="Endpoint number.">id</a>;
<a name="l00091"></a><a class="code" href="structat90usb__udc__ep.html#a5c3a3e365aa5f42a75cc86a68614a455">00091</a>         <span class="keyword">struct </span><a class="code" href="structat90usb__udc.html">at90usb_udc</a>    *<a class="code" href="structat90usb__udc__ep.html#a5c3a3e365aa5f42a75cc86a68614a455" title="Pointer to the UDC controller.">udc90</a>;
<a name="l00093"></a><a class="code" href="structat90usb__udc__ep.html#a56edd3c6ed34a417e4417ef64fcac829">00093</a>         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>          <a class="code" href="structat90usb__udc__ep.html#a56edd3c6ed34a417e4417ef64fcac829" title="EP0 buffer offset.">buf_offset</a>;
<a name="l00095"></a><a class="code" href="structat90usb__udc__ep.html#a46be98b0f2b43244d7155ddb1ea62bb9">00095</a>         <span class="keyword">struct </span><a class="code" href="structworkqueue__task.html" title="Task to be run from a work queue.">workqueue_task</a> <a class="code" href="structat90usb__udc__ep.html#a46be98b0f2b43244d7155ddb1ea62bb9" title="EP work queue.">task</a>;
<a name="l00097"></a><a class="code" href="structat90usb__udc__ep.html#adc480996e678c605bf3d65f6b8e376e7">00097</a>         <span class="keyword">struct </span><a class="code" href="structslist.html" title="A singly linked list.">slist</a>          <a class="code" href="structat90usb__udc__ep.html#adc480996e678c605bf3d65f6b8e376e7" title="EP USB requests.">req_queue</a>;
<a name="l00099"></a><a class="code" href="structat90usb__udc__ep.html#ae5a923e610e37a7533a968a703e3bb6b">00099</a>         <span class="keyword">struct </span><a class="code" href="structslist.html" title="A singly linked list.">slist</a>          <a class="code" href="structat90usb__udc__ep.html#ae5a923e610e37a7533a968a703e3bb6b" title="EP0 buffers for USB requests.">buf_queue</a>;
<a name="l00101"></a><a class="code" href="structat90usb__udc__ep.html#a9f8575a3661f47183dd0d8f7919afec0">00101</a>         <a class="code" href="group__bitops__group.html#gabd16df9e703c97e866a97611501495f2" title="Optimum type for bit operations.">bit_word_t</a>            <a class="code" href="structat90usb__udc__ep.html#a9f8575a3661f47183dd0d8f7919afec0" title="EP state flags.">flags</a>;
<a name="l00103"></a><a class="code" href="structat90usb__udc__ep.html#ac6048c7b155bdb243dd6b56a83a18c44">00103</a>         <a class="code" href="group__stdint__group.html#ga5a8b2dc9e45a9ee81a94ef304fb62505" title="16-bit unsigned integer">uint16_t</a>              <a class="code" href="structat90usb__udc__ep.html#ac6048c7b155bdb243dd6b56a83a18c44" title="EP maximum packet size.">maxpacket</a>;
<a name="l00105"></a><a class="code" href="structat90usb__udc__ep.html#aa821ba3cdb8a4bb3692f1f1b35f9fa06">00105</a>         <a class="code" href="group__stdint__group.html#ga5a8b2dc9e45a9ee81a94ef304fb62505" title="16-bit unsigned integer">uint16_t</a>              <a class="code" href="structat90usb__udc__ep.html#aa821ba3cdb8a4bb3692f1f1b35f9fa06" title="EP0 bytes written for an USB request.">bytes_written</a>;
<a name="l00106"></a>00106 };
<a name="l00107"></a>00107 
<a name="l00111"></a><a class="code" href="structat90usb__udc.html">00111</a> <span class="keyword">struct </span><a class="code" href="structat90usb__udc.html">at90usb_udc</a> {
<a name="l00113"></a><a class="code" href="structat90usb__udc.html#acb2b2b775d2487cd343617bc2e8058fe">00113</a>         <span class="keyword">struct </span><a class="code" href="structudc.html" title="A USB Device Controller.">udc</a>                <a class="code" href="structudc.html" title="A USB Device Controller.">udc</a>;
<a name="l00115"></a><a class="code" href="structat90usb__udc.html#a17e1b1a05edba61e9f4995603eadf6fc">00115</a>         <span class="keyword">enum</span> <a class="code" href="at90usb__internal_8h.html#a4e6f45a060f0609dd7bfb813184559f6">ep0_state</a>            <a class="code" href="structat90usb__udc.html#a17e1b1a05edba61e9f4995603eadf6fc" title="EP0 state.">ctrl_state</a>;
<a name="l00117"></a><a class="code" href="structat90usb__udc.html#a78f71c1a1203781abbd5280d3ad4f79a">00117</a>         <span class="keyword">struct </span><a class="code" href="structusb__setup__req.html" title="A USB Device SETUP request.">usb_setup_req</a>      <a class="code" href="structat90usb__udc.html#a78f71c1a1203781abbd5280d3ad4f79a" title="USB setup request data.">setup_req</a>;
<a name="l00119"></a><a class="code" href="structat90usb__udc.html#a524890f05a123ec6caacc875b3045fdf">00119</a>         <span class="keyword">struct </span><a class="code" href="structat90usb__controller.html">at90usb_controller</a> *<a class="code" href="structat90usb__udc.html#a524890f05a123ec6caacc875b3045fdf" title="Pointer to the USB controller.">at90usb</a>;
<a name="l00121"></a><a class="code" href="structat90usb__udc.html#aebf47ac0beaac4c1dde8fc98ba95ef50">00121</a>         <span class="keyword">struct </span><a class="code" href="structworkqueue__task.html" title="Task to be run from a work queue.">workqueue_task</a>     <a class="code" href="structat90usb__udc.html#aebf47ac0beaac4c1dde8fc98ba95ef50" title="UDC work queue.">task</a>;
<a name="l00123"></a><a class="code" href="structat90usb__udc.html#a3f8e7b2e75a2e1834de3f60eb20e8359">00123</a>         <span class="keyword">struct </span><a class="code" href="structat90usb__udc__ep.html">at90usb_udc_ep</a>     <a class="code" href="structat90usb__udc.html#a3f8e7b2e75a2e1834de3f60eb20e8359" title="Array of EPs.">ep</a>[APP_UDC_NR_ENDPOINTS];
<a name="l00124"></a>00124 };
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 
<a name="l00135"></a><a class="code" href="at90usb__internal_8h.html#a05f9b6cf4d21b918905185c3a0c72243">00135</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="at90usb__internal_8h.html#a05f9b6cf4d21b918905185c3a0c72243" title="Check if the AT90USB UDC controller is enabled.">at90usb_udc_is_enabled</a>(<span class="keyword">struct</span> <a class="code" href="structat90usb__udc.html">at90usb_udc</a> *<a class="code" href="structat90usb__udc__ep.html#a5c3a3e365aa5f42a75cc86a68614a455" title="Pointer to the UDC controller.">udc90</a>)
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137 <span class="preprocessor">#if defined(CONFIG_AT90USB_OTG)</span>
<a name="l00138"></a>00138 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <a class="code" href="group__bitops__group.html#gab6f6195f23a2985c9d6d1520e60ec3ad" title="Test bit nr in bitmap.">test_bit</a>(<a class="code" href="group__udc__group.html#gga8935b02daf1033b905c9bd51749e57b5a01d87782d04a61d661fd166ecbbb8f0c" title="Device Controller enabled.">UDC_IS_ENABLED</a>, &amp;udc90-&gt;<a class="code" href="structat90usb__udc.html#acb2b2b775d2487cd343617bc2e8058fe" title="The UDC controller.">udc</a>.<a class="code" href="structudc.html#a0efab065fbe68bae8ea948d19f6eccad" title="Bitmask of flags indicating the state of the device.">flags</a>);
<a name="l00139"></a>00139 <span class="preprocessor">#elif defined(CONFIG_UDC)</span>
<a name="l00140"></a>00140 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00141"></a>00141 <span class="preprocessor">#else</span>
<a name="l00142"></a>00142 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00143"></a>00143 <span class="preprocessor">#endif</span>
<a name="l00144"></a>00144 <span class="preprocessor"></span>}
<a name="l00145"></a>00145 
<a name="l00152"></a><a class="code" href="at90usb__internal_8h.html#a6e0c10c084530c8400097899000e36b1">00152</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="at90usb__internal_8h.html#a6e0c10c084530c8400097899000e36b1" title="Enable the AT90USB UDC controller.">at90usb_udc_enable</a>(<span class="keyword">struct</span> <a class="code" href="structat90usb__udc.html">at90usb_udc</a> *<a class="code" href="structat90usb__udc__ep.html#a5c3a3e365aa5f42a75cc86a68614a455" title="Pointer to the UDC controller.">udc90</a>)
<a name="l00153"></a>00153 {
<a name="l00154"></a>00154         <span class="comment">/*</span>
<a name="l00155"></a>00155 <span class="comment">         * Keep the autoattach flag as the application left it, set the</span>
<a name="l00156"></a>00156 <span class="comment">         * enabled flag and clear everything else. The AT90USB core driver</span>
<a name="l00157"></a>00157 <span class="comment">         * will check the Vbus state right after enabling the</span>
<a name="l00158"></a>00158 <span class="comment">         * controller.</span>
<a name="l00159"></a>00159 <span class="comment">         */</span>
<a name="l00160"></a>00160         udc90-&gt;<a class="code" href="structat90usb__udc.html#acb2b2b775d2487cd343617bc2e8058fe" title="The UDC controller.">udc</a>.<a class="code" href="structudc.html#a0efab065fbe68bae8ea948d19f6eccad" title="Bitmask of flags indicating the state of the device.">flags</a> &amp;= (1 &lt;&lt; <a class="code" href="group__udc__group.html#gga8935b02daf1033b905c9bd51749e57b5a01d87782d04a61d661fd166ecbbb8f0c" title="Device Controller enabled.">UDC_IS_ENABLED</a>) | (1 &lt;&lt; <a class="code" href="group__udc__group.html#gga8935b02daf1033b905c9bd51749e57b5a75413d1b8163e224b9a964dab1d50db8" title="Attach when possible.">UDC_AUTOATTACH</a>);
<a name="l00161"></a>00161         udc90-&gt;<a class="code" href="structat90usb__udc.html#acb2b2b775d2487cd343617bc2e8058fe" title="The UDC controller.">udc</a>.<a class="code" href="structudc.html#a0efab065fbe68bae8ea948d19f6eccad" title="Bitmask of flags indicating the state of the device.">flags</a> |= (1 &lt;&lt; <a class="code" href="group__udc__group.html#gga8935b02daf1033b905c9bd51749e57b5a01d87782d04a61d661fd166ecbbb8f0c" title="Device Controller enabled.">UDC_IS_ENABLED</a>);
<a name="l00162"></a>00162 }
<a name="l00163"></a>00163 
<a name="l00170"></a><a class="code" href="at90usb__internal_8h.html#a529169ef5b14c266284c1c110fea5e0e">00170</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="at90usb__internal_8h.html#a529169ef5b14c266284c1c110fea5e0e" title="Disable the AT90USB UDC controller.">at90usb_udc_disable</a>(<span class="keyword">struct</span> <a class="code" href="structat90usb__udc.html">at90usb_udc</a> *<a class="code" href="structat90usb__udc__ep.html#a5c3a3e365aa5f42a75cc86a68614a455" title="Pointer to the UDC controller.">udc90</a>)
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172         <span class="comment">/*</span>
<a name="l00173"></a>00173 <span class="comment">         * Clear all flags except the autoattach flag set by the</span>
<a name="l00174"></a>00174 <span class="comment">         * application</span>
<a name="l00175"></a>00175 <span class="comment">         */</span>
<a name="l00176"></a>00176         udc90-&gt;<a class="code" href="structat90usb__udc.html#acb2b2b775d2487cd343617bc2e8058fe" title="The UDC controller.">udc</a>.<a class="code" href="structudc.html#a0efab065fbe68bae8ea948d19f6eccad" title="Bitmask of flags indicating the state of the device.">flags</a> &amp;= (1 &lt;&lt; <a class="code" href="group__udc__group.html#gga8935b02daf1033b905c9bd51749e57b5a75413d1b8163e224b9a964dab1d50db8" title="Attach when possible.">UDC_AUTOATTACH</a>);
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="group__udc__group.html#ga59d6920f3d1da0b8c3f5eeecac367589" title="Signal that a low Vbus level has been detected.">at90usb_udc_vbus_off</a>(<span class="keyword">struct</span> <a class="code" href="structat90usb__udc.html">at90usb_udc</a> *<a class="code" href="structat90usb__udc__ep.html#a5c3a3e365aa5f42a75cc86a68614a455" title="Pointer to the UDC controller.">udc90</a>);
<a name="l00180"></a>00180 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="group__udc__group.html#gabf8d919c60a8135a89d37e3036cfb459" title="Signal that a high Vbus level has been detected.">at90usb_udc_vbus_on</a>(<span class="keyword">struct</span> <a class="code" href="structat90usb__udc.html">at90usb_udc</a> *<a class="code" href="structat90usb__udc__ep.html#a5c3a3e365aa5f42a75cc86a68614a455" title="Pointer to the UDC controller.">udc90</a>);
<a name="l00181"></a>00181 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structat90usb__udc.html">at90usb_udc</a> *<a class="code" href="group__udc__group.html#ga3cff978366b61d760e6163154af4c8f6" title="Initialize the device part of the AT90USB controller.">at90usb_udc_init</a>(<span class="keywordtype">void</span>);
<a name="l00182"></a>00182 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="group__udc__group.html#ga260d2f316b9a1bbc5e0f528a337f3015" title="Shut down the device part of the AT90USB controller.">at90usb_udc_shutdown</a>(<span class="keyword">struct</span> <a class="code" href="structat90usb__udc.html">at90usb_udc</a> *udc90);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">/* USB Host part */</span>
<a name="l00185"></a>00185 
<a name="l00189"></a><a class="code" href="structat90usb__host.html">00189</a> <span class="keyword">struct </span><a class="code" href="structat90usb__host.html">at90usb_host</a> {
<a name="l00190"></a>00190         <span class="comment">/* Empty structs are not allowed in general. */</span>
<a name="l00191"></a>00191         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> placeholder;
<a name="l00192"></a>00192 };
<a name="l00193"></a>00193 
<a name="l00202"></a><a class="code" href="at90usb__internal_8h.html#a62727ae025bb7d732ef60d18fe6c4e7b">00202</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="at90usb__internal_8h.html#a62727ae025bb7d732ef60d18fe6c4e7b" title="Check if the AT90USB host controller is enabled.">at90usb_host_is_enabled</a>(<span class="keyword">struct</span> <a class="code" href="structat90usb__host.html">at90usb_host</a> *host90)
<a name="l00203"></a>00203 {
<a name="l00204"></a>00204 <span class="preprocessor">#if defined(CONFIG_AT90USB_OTG)</span>
<a name="l00205"></a>00205 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <a class="code" href="group__bitops__group.html#gab6f6195f23a2985c9d6d1520e60ec3ad" title="Test bit nr in bitmap.">test_bit</a>(USB_HOST_IS_ENABLED, &amp;host90-&gt;hcd.flags);
<a name="l00206"></a>00206 <span class="preprocessor">#else</span>
<a name="l00207"></a>00207 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00208"></a>00208 <span class="preprocessor">#endif</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span>}
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> at90usb_host_enable(<span class="keyword">struct</span> <a class="code" href="structat90usb__host.html">at90usb_host</a> *host90)
<a name="l00212"></a>00212 {
<a name="l00213"></a>00213         <span class="comment">// TODO</span>
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> at90usb_host_disable(<span class="keyword">struct</span> <a class="code" href="structat90usb__host.html">at90usb_host</a> *host90)
<a name="l00217"></a>00217 {
<a name="l00218"></a>00218         <span class="comment">// TODO</span>
<a name="l00219"></a>00219 }
<a name="l00220"></a>00220 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structat90usb__host.html">at90usb_host</a> *at90usb_host_init(<span class="keywordtype">void</span>);
<a name="l00221"></a>00221 <span class="keyword">extern</span> <span class="keywordtype">void</span> at90usb_host_shutdown(<span class="keyword">struct</span> <a class="code" href="structat90usb__host.html">at90usb_host</a> *host90);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 <span class="comment">/* USB Master and OTG part */</span>
<a name="l00224"></a>00224 
<a name="l00228"></a><a class="code" href="structat90usb__controller.html">00228</a> <span class="keyword">struct </span><a class="code" href="structat90usb__controller.html">at90usb_controller</a> {
<a name="l00229"></a>00229 <span class="preprocessor">#ifdef CONFIG_UDC</span>
<a name="l00230"></a>00230 <span class="preprocessor"></span>        <span class="keyword">struct </span><a class="code" href="structat90usb__udc.html">at90usb_udc</a> *<a class="code" href="structudc.html" title="A USB Device Controller.">udc</a>;
<a name="l00231"></a>00231 <span class="preprocessor">#endif</span>
<a name="l00232"></a>00232 <span class="preprocessor"></span>};
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 <span class="preprocessor">#endif </span><span class="comment">/* AT90USB_INTERNAL_H_INCLUDED */</span>
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Apr 29 14:10:34 2010 for xplain-bc by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
