<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>xplain-bc: Generic DMA pool allocator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Generic DMA pool allocator<br/>
<small>
[<a class="el" href="group__dmapool__group.html">DMA pool allocator</a>]</small>
</h1>
<p><div class="dynheader">
Collaboration diagram for Generic DMA pool allocator:</div>
<div class="dynsection">
<center><table><tr><td><img src="group__dmapool__generic__group.png" border="0" alt="" usemap="#group____dmapool____generic____group_map"/>
<map name="group____dmapool____generic____group_map" id="group____dmapool____generic____group">
<area shape="rect" href="group__dmapool__group.html" title="DMA pool allocator" alt="" coords="7,5,137,35"/></map></td></tr></table></center>
</div>
</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="uniondma__addr__t.html">dma_addr_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dmapool__generic__group.html#ga3aa00b0494ff313396081bddfb87bbaf">dma_alloc</a> (size_t size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate an object from the generic DMA pools.  <a href="#ga3aa00b0494ff313396081bddfb87bbaf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dmapool__generic__group.html#ga70ff9a0bae4405abdf0d4e7a05754850">dma_free</a> (<a class="el" href="uniondma__addr__t.html">dma_addr_t</a> obj, size_t size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free an object to the generic DMA pools.  <a href="#ga70ff9a0bae4405abdf0d4e7a05754850"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The <em>Generic DMA pool allocator</em> allows DMA objects to be allocated without setting up a dedicated pool for them. When enabled, the generic DMA pool allocator will set up two "generic" pools: One for large objects and one for small objects. The application may specify the number and size of these objects by providing the following definitions in the configuration makefile:</p>
<ul>
<li>CONFIG_DMAPOOL_SMALL_OBJ_SIZE: The size of each "small" object</li>
<li>CONFIG_DMAPOOL_NR_SMALL_OBJS: The number of "small" objects available</li>
<li>CONFIG_DMAPOOL_LARGE_OBJ_SIZE: The size of each "large" object</li>
<li>CONFIG_DMAPOOL_NR_LARGE_OBJS: The number of "large" objects available</li>
</ul>
<p>Based on the requested size, the smallest pool which is large enough to satisfy the allocation is selected automatically. If the application doesn't provide any of the above definitions for one of the pools, that pool will be unavailable and all allocations will be made from the other pool.</p>
<p>The memory returned by the generic DMA pool allocator is coherent, so there's no need to perform any cache synchronization. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga3aa00b0494ff313396081bddfb87bbaf"></a><!-- doxytag: member="dmapool.h::dma_alloc" ref="ga3aa00b0494ff313396081bddfb87bbaf" args="(size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="uniondma__addr__t.html">dma_addr_t</a> dma_alloc </td>
          <td>(</td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Allocate an object from the generic DMA pools. </p>
<p>This function picks the smallest generic DMA pool which can hold objects of size greater than or equal to <em>size</em> and allocates an object from it.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Minimum size of the object to allocate</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A physical/virtual address pair of an object of at least <em>size</em> bytes, or NULL if the selected DMA pool is exhausted. </dd></dl>

<p>Definition at line <a class="el" href="include_2dmapool_8h_source.html#l00176">176</a> of file <a class="el" href="include_2dmapool_8h_source.html">dmapool.h</a>.</p>

<p>References <a class="el" href="compiler_8h_source.html#l00259">is_constant</a>.</p>

</div>
</div>
<a class="anchor" id="ga70ff9a0bae4405abdf0d4e7a05754850"></a><!-- doxytag: member="dmapool.h::dma_free" ref="ga70ff9a0bae4405abdf0d4e7a05754850" args="(dma_addr_t obj, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void dma_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="uniondma__addr__t.html">dma_addr_t</a>&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Free an object to the generic DMA pools. </p>
<p>This function picks the same generic DMA pool picked based on <em>size</em>, and frees the object to it.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>obj</em>&nbsp;</td><td>The object to be freed. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>The minimum size of the object. Must be the same value as was passed to <a class="el" href="group__dmapool__generic__group.html#ga3aa00b0494ff313396081bddfb87bbaf" title="Allocate an object from the generic DMA pools.">dma_alloc()</a> when this object was returned. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="include_2dmapool_8h_source.html#l00205">205</a> of file <a class="el" href="include_2dmapool_8h_source.html">dmapool.h</a>.</p>

<p>References <a class="el" href="compiler_8h_source.html#l00259">is_constant</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Apr 29 14:10:35 2010 for xplain-bc by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
