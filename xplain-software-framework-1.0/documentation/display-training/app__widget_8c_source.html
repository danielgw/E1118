<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>display-training: apps/display-training/app_widget.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>apps/display-training/app_widget.c</h1><a href="app__widget_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="board_2xplain_2include_2board_2led_8h.html" title="Board-specific LED control.">led.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="board_8h.html" title="Xplain ATxmega128A1 board-specific declarations.">board.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="arch_2avr8_2include_2arch_2string_8h.html" title="Standard string operations for AVR.">string.h</a>&gt;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="gfx_8h.html" title="General graphics routines header file.">gfx/gfx.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;<a class="code" href="include_2gfx_2win_8h.html" title="Graphical Window system.">gfx/win.h</a>&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="include_2gfx_2wtk_8h.html" title="Graphical Widget toolkit.">gfx/wtk.h</a>&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="include_2gfx_2sysfont_8h.html" title="Graphical Window system.">gfx/sysfont.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="include_2membag_8h.html" title="Memory bag allocator.">membag.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="debug_8h.html" title="Debug console.">debug.h</a>&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;<a class="code" href="mainloop_8h.html" title="Main loop processing.">mainloop.h</a>&gt;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;<a class="code" href="arch_2avr8_2include_2arch_2string_8h.html" title="Standard string operations for AVR.">string.h</a>&gt;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;<a class="code" href="stream_8h.html" title="Character stream interface.">stream.h</a>&gt;</span>
<a name="l00052"></a>00052 
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="app__widget_8h.html" title="Display training widget application.">app_widget.h</a>&quot;</span>
<a name="l00054"></a>00054 
<a name="l00067"></a><a class="code" href="group__app__widget__group.html#gacf97ed0c95e3bddca7bbf304bde08d33">00067</a> <span class="keyword">enum</span> <a class="code" href="group__app__widget__group.html#gacf97ed0c95e3bddca7bbf304bde08d33" title="Event command ID for the application widgets.">app_widget_ids</a> {
<a name="l00069"></a><a class="code" href="group__app__widget__group.html#ggacf97ed0c95e3bddca7bbf304bde08d33afc8f638e3da90e7668c344b40153b6c4">00069</a>         <a class="code" href="group__app__widget__group.html#ggacf97ed0c95e3bddca7bbf304bde08d33afc8f638e3da90e7668c344b40153b6c4" title="Event command ID for the slider.">SLIDER_ID</a> = 1,
<a name="l00071"></a><a class="code" href="group__app__widget__group.html#ggacf97ed0c95e3bddca7bbf304bde08d33ac5a68bc932e0a7936aa57c271d49d855">00071</a>         <a class="code" href="group__app__widget__group.html#ggacf97ed0c95e3bddca7bbf304bde08d33ac5a68bc932e0a7936aa57c271d49d855" title="Event command ID for the button.">BUTTON_ID</a>,
<a name="l00072"></a>00072 };
<a name="l00073"></a>00073 
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="group__app__widget__group.html#gae8721616eb76f7dd949b941a7c1a6df5">00081</a> <span class="preprocessor">#define APP_BACKGROUND_COLOR        GFX_COLOR(50, 50, 50)</span>
<a name="l00082"></a>00082 <span class="preprocessor"></span>
<a name="l00084"></a>00084 
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="group__app__widget__group.html#ga858197c967901f3bc8ad7c5a24c0de5a">00092</a> <span class="preprocessor">#define LABEL_POS_X                 10</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span>
<a name="l00094"></a><a class="code" href="group__app__widget__group.html#ga95ca3695a2b130f5c9f18725210bba28">00094</a> <span class="preprocessor">#define LABEL_POS_Y                 10</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span>
<a name="l00097"></a><a class="code" href="group__app__widget__group.html#ga59b0b3f35f89dd1fcb821c735044bf3b">00097</a> <span class="preprocessor">#define SLIDER_POS_X                10</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>
<a name="l00099"></a><a class="code" href="group__app__widget__group.html#ga174764c602365c17ea10783ca7b3b404">00099</a> <span class="preprocessor">#define SLIDER_POS_Y                60</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span>
<a name="l00101"></a><a class="code" href="group__app__widget__group.html#ga5abb3203c51e3b101c0111552bdd5f6e">00101</a> <span class="preprocessor">#define SLIDER_SIZE_X               80</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>
<a name="l00103"></a><a class="code" href="group__app__widget__group.html#ga0029c0fa7dac7923c1c9285a020432f8">00103</a> <span class="preprocessor">#define SLIDER_SIZE_Y               40</span>
<a name="l00104"></a>00104 <span class="preprocessor"></span>
<a name="l00106"></a><a class="code" href="group__app__widget__group.html#ga4fa02143768ea5bca99c4d220e5b6fff">00106</a> <span class="preprocessor">#define SLIDER_PB_SPACING_X         10</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span>
<a name="l00108"></a><a class="code" href="group__app__widget__group.html#ga40e2939dae3808c9ad5fccc968fcba49">00108</a> <span class="preprocessor">#define PB_SIZE_X                   SLIDER_SIZE_X</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span>
<a name="l00110"></a><a class="code" href="group__app__widget__group.html#ga7778bd242cc3e4b3995498b0c1d9fad3">00110</a> <span class="preprocessor">#define PB_SIZE_Y                   SLIDER_SIZE_Y</span>
<a name="l00111"></a>00111 <span class="preprocessor"></span>
<a name="l00113"></a>00113 
<a name="l00120"></a>00120 
<a name="l00121"></a><a class="code" href="group__app__widget__group.html#ga4991bdb8315f462d6f92813a04a36f1d">00121</a> <span class="preprocessor">#define SLIDER_MAX_VALUE            100</span>
<a name="l00122"></a>00122 <span class="preprocessor"></span>
<a name="l00124"></a>00124 
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="group__app__widget__group.html#ga58fd1c314a2e3428b7c43337deef9d66">00132</a> <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">char</span>                   *<a class="code" href="group__app__widget__group.html#ga58fd1c314a2e3428b7c43337deef9d66" title="Description for label.">demo_string</a> = <span class="stringliteral">&quot;Demonstrating widgets&quot;</span>;
<a name="l00133"></a>00133 
<a name="l00135"></a>00135 
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="group__app__widget__group.html#gaa1609eacc47c12c4f864af7aa6a177f1">00143</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structwtk__basic__frame.html" title="Basic frame control struct.">wtk_basic_frame</a>       *<a class="code" href="group__app__widget__group.html#gaa1609eacc47c12c4f864af7aa6a177f1" title="Pointer to frame for application.">frame</a>;
<a name="l00145"></a><a class="code" href="group__app__widget__group.html#ga26b0162371df25ecfcdeced2a2433d0f">00145</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a>            *<a class="code" href="group__app__widget__group.html#ga26b0162371df25ecfcdeced2a2433d0f" title="Pointer to slider.">slider</a>;
<a name="l00147"></a><a class="code" href="group__app__widget__group.html#ga7a8d4514b3ffe2e8ae640bf7345d006a">00147</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structwtk__progress__bar.html" title="Progress bar control struct.">wtk_progress_bar</a>      *<a class="code" href="group__app__widget__group.html#ga7a8d4514b3ffe2e8ae640bf7345d006a" title="Pointer to progress bar.">progress_bar</a>;
<a name="l00149"></a><a class="code" href="group__app__widget__group.html#ga81de9f34215ac43b848531b57aedc5e0">00149</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structgfx__bitmap.html" title="Storage structure for bitmap pixel data and metadata.">gfx_bitmap</a>            <a class="code" href="group__app__widget__group.html#ga81de9f34215ac43b848531b57aedc5e0" title="Frame background bitmap.">frame_background</a>;
<a name="l00151"></a><a class="code" href="group__app__widget__group.html#ga0480b812cba9c1d9c71a5fb1071bd0fc">00151</a> <span class="keyword">static</span> <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a>                      <a class="code" href="group__app__widget__group.html#ga0480b812cba9c1d9c71a5fb1071bd0fc" title="Counter for button.">counter</a>;
<a name="l00153"></a><a class="code" href="group__app__widget__group.html#gac262d019a7b7a15996ec613491cb8483">00153</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structwtk__basic__frame.html" title="Basic frame control struct.">wtk_basic_frame</a>       *<a class="code" href="group__app__widget__group.html#gac262d019a7b7a15996ec613491cb8483" title="Pointer to the sub-frame.">sub_frame</a>;
<a name="l00155"></a><a class="code" href="group__app__widget__group.html#ga45db49ed3dce8f348dea86573f0c5552">00155</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structgfx__bitmap.html" title="Storage structure for bitmap pixel data and metadata.">gfx_bitmap</a>            <a class="code" href="group__app__widget__group.html#ga45db49ed3dce8f348dea86573f0c5552" title="Sub-frame background bitmap.">sub_frame_background</a>;
<a name="l00156"></a>00156 
<a name="l00158"></a>00158 
<a name="l00166"></a><a class="code" href="group__app__widget__group.html#ga92d28032a15ad54242630dda26e06dcd">00166</a> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="group__app__widget__group.html#ga92d28032a15ad54242630dda26e06dcd" title="Frame command events handler.">widget_frame_command_handler</a>(<span class="keyword">struct</span> <a class="code" href="structwtk__basic__frame.html" title="Basic frame control struct.">wtk_basic_frame</a> *frame,
<a name="l00167"></a>00167                 <a class="code" href="group__gfx__win.html#ga53f0ed533fce454af67e765764d7eb5f" title="Custom data, can be used as a data pointer or data depending on the application.">win_command_t</a> command_data)
<a name="l00168"></a>00168 {
<a name="l00169"></a>00169         <span class="keywordtype">char</span> command = (char)(<a class="code" href="group__stdint__group.html#ga2f2d463af0e2a9da3ecdd102ce312832" title="Unsigned integer type capable of holding a pointer.">uintptr_t</a>)command_data;
<a name="l00170"></a>00170 
<a name="l00171"></a>00171         <span class="keywordflow">switch</span> (command) {
<a name="l00172"></a>00172         <span class="keywordflow">case</span> <a class="code" href="group__app__widget__group.html#ggacf97ed0c95e3bddca7bbf304bde08d33afc8f638e3da90e7668c344b40153b6c4" title="Event command ID for the slider.">SLIDER_ID</a>:
<a name="l00173"></a>00173                 <a class="code" href="group__gfx__wtk__progress__bar.html#ga36d595cfd3afc89055a8033c43b5b54a" title="Set new progress bar value.">wtk_progress_bar_set_value</a>(progress_bar,
<a name="l00174"></a>00174                                 <a class="code" href="group__gfx__wtk__slider.html#ga685ad61e500fe87c9a50b4353fc926f6" title="Get slider value.">wtk_slider_get_value</a>(slider));
<a name="l00175"></a>00175                 <span class="keywordflow">break</span>;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177         <span class="keywordflow">case</span> <a class="code" href="group__app__widget__group.html#ggacf97ed0c95e3bddca7bbf304bde08d33ac5a68bc932e0a7936aa57c271d49d855" title="Event command ID for the button.">BUTTON_ID</a>:
<a name="l00179"></a>00179                 <a class="code" href="group__app__widget__group.html#ga0480b812cba9c1d9c71a5fb1071bd0fc" title="Counter for button.">counter</a>++;
<a name="l00180"></a>00180                 <a class="code" href="group__gfx__win.html#ga7f5e9dd7246c26ade8a7a3a764b3dc74" title="Redraw window and its contents, if visible.">win_redraw</a>(<a class="code" href="group__gfx__wtk__basic__frame.html#ga288ea10860d82def003800b19222ab0c" title="Get reference to basic frame window.">wtk_basic_frame_as_child</a>(sub_frame));
<a name="l00181"></a>00181                 <span class="keywordflow">break</span>;
<a name="l00182"></a>00182         }
<a name="l00183"></a>00183 
<a name="l00184"></a>00184         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00185"></a>00185 }
<a name="l00186"></a>00186 
<a name="l00194"></a><a class="code" href="group__app__widget__group.html#ga6201d3818c7546dcadec254eb3bc03ac">00194</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="group__app__widget__group.html#ga6201d3818c7546dcadec254eb3bc03ac" title="Frame draw event handler.">sub_frame_draw_handler</a>(<span class="keyword">struct</span> <a class="code" href="structwin__window.html" title="Window control data.">win_window</a> *win,
<a name="l00195"></a>00195                 <span class="keyword">struct</span> <a class="code" href="structwin__clip__region.html" title="Geometric type describing a clipping region, used when drawing windows.">win_clip_region</a> <span class="keyword">const</span> *clip)
<a name="l00196"></a>00196 {
<a name="l00197"></a>00197         <span class="keywordtype">char</span> <a class="code" href="structbuffer.html" title="A generic data buffer.">buffer</a>[4];
<a name="l00198"></a>00198 
<a name="l00199"></a>00199         <a class="code" href="stream__string_8c.html#ad76145a6edfc98981ded8815a760e0cd" title="Streamed formatted size limited output conversion.">snprintf</a>(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;%3d&quot;</span>, <a class="code" href="group__app__widget__group.html#ga0480b812cba9c1d9c71a5fb1071bd0fc" title="Counter for button.">counter</a>);
<a name="l00204"></a>00204         <a class="code" href="group__gfx__gfx.html#gaf6bb28b793aa67278db46230b72d6c50" title="Draws a string to the display.">gfx_draw_string</a>(buffer, clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.x + 30, clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.y + 12,
<a name="l00205"></a>00205                         &amp;<a class="code" href="group__gfx__sysfont.html#ga9df1a6a09f606d5fa00dc3a2be10aabb" title="Initialize a basic system font.">sysfont</a>, <a class="code" href="group__gfx__gfx.html#ga211e684859b29d9a8a5943d1498d533c" title="Generate a display-native color value from constant RGB components.">GFX_COLOR</a>(255, 255, 255),
<a name="l00206"></a>00206                         <a class="code" href="group__gfx__gfx.html#gab8aa45e3febdfb476408dffba0cc0103" title="Value used as input to font functions to give a transparent background region.">GFX_COLOR_TRANSPARENT</a>);
<a name="l00207"></a>00207 }
<a name="l00208"></a>00208 
<a name="l00216"></a>00216 <span class="keywordtype">void</span> <a class="code" href="group__app__widget__group.html#gabb33b8583f6e6ebbb4d7f39ede5c18b2" title="Setup widget demo.">app_widget_launch</a>(<span class="keyword">struct</span> <a class="code" href="structworkqueue__task.html" title="Task to be run from a work queue.">workqueue_task</a> *task) {
<a name="l00217"></a>00217 
<a name="l00218"></a>00218         <span class="keyword">struct </span><a class="code" href="structwin__window.html" title="Window control data.">win_window</a>       *<a class="code" href="group__gfx__win.html#ga5733efc0d1a2cf900afae4df206c8ff6" title="Root window, i.e. desktop window.">win_root</a>;
<a name="l00219"></a>00219         <span class="keyword">struct </span><a class="code" href="structwin__window.html" title="Window control data.">win_window</a>       *<a class="code" href="structwin__window.html#a252cb3f034971464404e055db6859a3a" title="Parent window.">parent</a>;
<a name="l00220"></a>00220         <span class="keyword">struct </span><a class="code" href="structwin__area.html" title="Geometric type describing an area on screen.">win_area</a>         area;
<a name="l00221"></a>00221         <span class="keyword">struct </span><a class="code" href="structwtk__label.html">wtk_label</a>        *lbl;
<a name="l00222"></a>00222         <span class="keyword">struct </span><a class="code" href="structwtk__button.html">wtk_button</a>       *btn;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224         <span class="comment">// Use larger sysfont for this app</span>
<a name="l00225"></a>00225         <a class="code" href="group__gfx__sysfont.html#ga9df1a6a09f606d5fa00dc3a2be10aabb" title="Initialize a basic system font.">sysfont</a>.<a class="code" href="structfont.html#a93930e293fe0c2a740da28bbd8f1a46d" title="Number of times characters are scaled up when being drawn.">scale</a> = 2;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227         <span class="comment">// Get pointer to root window</span>
<a name="l00228"></a>00228         win_root = <a class="code" href="group__gfx__win.html#gabb0c95ee3810418e2dff2264aac277fa" title="Get pointer to root window, i.e. desktop window.">win_get_root</a>();
<a name="l00229"></a>00229 
<a name="l00230"></a>00230         <span class="comment">// Application frame</span>
<a name="l00231"></a>00231 
<a name="l00232"></a>00232         <span class="comment">// Create a background bitmap using a solid color.</span>
<a name="l00233"></a>00233         <a class="code" href="group__app__widget__group.html#ga81de9f34215ac43b848531b57aedc5e0" title="Frame background bitmap.">frame_background</a>.<a class="code" href="structgfx__bitmap.html#a25e3747161bb4053f91cbaab6bdc216d" title="Bitmap type.">type</a> = <a class="code" href="group__gfx__gfx.html#ggaaa3d242c7c08ccafbb00bbcfabe27e3fa5347f7bf0548ae0c3cc8210f49b937a6" title="Solid color bitmap.">BITMAP_SOLID</a>;
<a name="l00234"></a>00234         <a class="code" href="group__app__widget__group.html#ga81de9f34215ac43b848531b57aedc5e0" title="Frame background bitmap.">frame_background</a>.data.<a class="code" href="structgfx__bitmap.html#a79b389912a0bf990d9c23e8b21f02569" title="Color for solid color bitmaps.">color</a> = <a class="code" href="group__app__widget__group.html#gae8721616eb76f7dd949b941a7c1a6df5" title="Background color for application.">APP_BACKGROUND_COLOR</a>;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236         <span class="comment">// Set the area to fill the entire screen</span>
<a name="l00237"></a>00237         area.pos.x = 0;
<a name="l00238"></a>00238         area.pos.y = 0;
<a name="l00239"></a>00239         area.size.x = <a class="code" href="group__gfx__gfx.html#ga08c77dc3294e612b75aa054f77f22773" title="Return the current width of the screen.">gfx_get_width</a>();
<a name="l00240"></a>00240         area.size.y = <a class="code" href="group__gfx__gfx.html#ga18bda375fb523cfcb6f41862be5ba7b4" title="Return the current height of the screen.">gfx_get_height</a>();
<a name="l00241"></a>00241 
<a name="l00242"></a>00242         <span class="comment">/*</span>
<a name="l00243"></a>00243 <span class="comment">         * Create a basic frame with a specified background and command event</span>
<a name="l00244"></a>00244 <span class="comment">         * handler. Check the return value if an error occured while creating</span>
<a name="l00245"></a>00245 <span class="comment">         * the widget.</span>
<a name="l00246"></a>00246 <span class="comment">         */</span>
<a name="l00247"></a>00247         frame = <a class="code" href="group__gfx__wtk__basic__frame.html#ga2ef82bf721f8db8440ef4bdaa5e9a982" title="Create basic frame widget.">wtk_basic_frame_create</a>(win_root, &amp;area,
<a name="l00248"></a>00248                         &amp;<a class="code" href="group__app__widget__group.html#ga81de9f34215ac43b848531b57aedc5e0" title="Frame background bitmap.">frame_background</a>, NULL,
<a name="l00249"></a>00249                         <a class="code" href="group__app__widget__group.html#ga92d28032a15ad54242630dda26e06dcd" title="Frame command events handler.">widget_frame_command_handler</a>, NULL);
<a name="l00250"></a>00250         <span class="keywordflow">if</span> (!frame) {
<a name="l00251"></a>00251                 <span class="keywordflow">goto</span> error_frame;
<a name="l00252"></a>00252         }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254         <span class="comment">// Get a pointer to the widget&#39;s window for adding sub-widgets.</span>
<a name="l00255"></a>00255         parent = <a class="code" href="group__gfx__wtk__basic__frame.html#ga288ea10860d82def003800b19222ab0c" title="Get reference to basic frame window.">wtk_basic_frame_as_child</a>(frame);
<a name="l00256"></a>00256         <span class="comment">/*</span>
<a name="l00257"></a>00257 <span class="comment">         * Draw the frame by showing the frame widget&#39;s window. Any</span>
<a name="l00258"></a>00258 <span class="comment">         * child-widgets and windows will not be shown before the parent</span>
<a name="l00259"></a>00259 <span class="comment">         * widget/window is shown.</span>
<a name="l00260"></a>00260 <span class="comment">         */</span>
<a name="l00261"></a>00261         <a class="code" href="group__gfx__win.html#gacf174cc778747a982b36cbe05e0d247d" title="Show window. Will draw it on screen if parent is visible as well.">win_show</a>(parent);
<a name="l00262"></a>00262 
<a name="l00263"></a>00263         <span class="comment">// Application label</span>
<a name="l00264"></a>00264         area.pos.x = <a class="code" href="group__app__widget__group.html#ga858197c967901f3bc8ad7c5a24c0de5a" title="Label position on top of display.">LABEL_POS_X</a>;
<a name="l00265"></a>00265         area.pos.y = <a class="code" href="group__app__widget__group.html#ga95ca3695a2b130f5c9f18725210bba28" title="Label position on top of display.">LABEL_POS_Y</a>;
<a name="l00266"></a>00266         <span class="comment">// Find an optimal size for the widget.</span>
<a name="l00267"></a>00267         <a class="code" href="group__gfx__wtk__label.html#gac0b3e98bcab98c362e25caab63af78fd" title="Get minimum widget size.">wtk_label_size_hint</a>(&amp;area.size, <a class="code" href="group__app__widget__group.html#ga58fd1c314a2e3428b7c43337deef9d66" title="Description for label.">demo_string</a>);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <span class="comment">/*</span>
<a name="l00270"></a>00270 <span class="comment">         * Create the label and check the return value if an error occured</span>
<a name="l00271"></a>00271 <span class="comment">         * while creating the label.</span>
<a name="l00272"></a>00272 <span class="comment">         */</span>
<a name="l00273"></a>00273         lbl = <a class="code" href="group__gfx__wtk__label.html#gaba01e03f0544afa6636be71df716c3fd">wtk_label_create</a>(parent, &amp;area, <a class="code" href="group__app__widget__group.html#ga58fd1c314a2e3428b7c43337deef9d66" title="Description for label.">demo_string</a>, <span class="keyword">false</span>);
<a name="l00274"></a>00274         <span class="keywordflow">if</span> (!lbl) {
<a name="l00275"></a>00275                 <span class="keywordflow">goto</span> error_widget;
<a name="l00276"></a>00276         }
<a name="l00277"></a>00277 
<a name="l00278"></a>00278         <span class="comment">// Draw the label by showing the label widget&#39;s window.</span>
<a name="l00279"></a>00279         <a class="code" href="group__gfx__win.html#gacf174cc778747a982b36cbe05e0d247d" title="Show window. Will draw it on screen if parent is visible as well.">win_show</a>(<a class="code" href="group__gfx__wtk__label.html#ga8764b372528db23f52d80ffe692a5679">wtk_label_as_child</a>(lbl));
<a name="l00280"></a>00280 
<a name="l00281"></a>00281         <span class="comment">// Application slider</span>
<a name="l00282"></a>00282         area.pos.x = <a class="code" href="group__app__widget__group.html#ga59b0b3f35f89dd1fcb821c735044bf3b" title="Slider position.">SLIDER_POS_X</a>;
<a name="l00283"></a>00283         area.pos.y = <a class="code" href="group__app__widget__group.html#ga174764c602365c17ea10783ca7b3b404" title="Slider position.">SLIDER_POS_Y</a>;
<a name="l00284"></a>00284         area.size.x = <a class="code" href="group__app__widget__group.html#ga5abb3203c51e3b101c0111552bdd5f6e" title="Slider size on display.">SLIDER_SIZE_X</a>;
<a name="l00285"></a>00285         area.size.y = <a class="code" href="group__app__widget__group.html#ga0029c0fa7dac7923c1c9285a020432f8" title="Slider size on display.">SLIDER_SIZE_Y</a>;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287         <span class="comment">/*</span>
<a name="l00288"></a>00288 <span class="comment">         * Create the slider and check the return value if an error occured</span>
<a name="l00289"></a>00289 <span class="comment">         * while creating the slider.</span>
<a name="l00290"></a>00290 <span class="comment">         */</span>
<a name="l00291"></a>00291         slider = <a class="code" href="group__gfx__wtk__slider.html#ga9e568e682198071b0ed1d0baba6d24d3" title="Create a new slider widget.">wtk_slider_create</a>(parent, &amp;area, <a class="code" href="group__app__widget__group.html#ga4991bdb8315f462d6f92813a04a36f1d" title="Max value for slider.">SLIDER_MAX_VALUE</a>,
<a name="l00292"></a>00292                         <a class="code" href="group__app__widget__group.html#ga4991bdb8315f462d6f92813a04a36f1d" title="Max value for slider.">SLIDER_MAX_VALUE</a> / 2, <a class="code" href="group__gfx__wtk__slider__options.html#ga7064e330bf2d6543c68e05b44cb46317" title="Slider is horizontally oriented. (Default option).">WTK_SLIDER_HORIZONTAL</a>|<a class="code" href="group__gfx__wtk__slider__options.html#ga4e587f08b054a5edd2a559c98d25ac82" title="Issue command event whenever slider is released.">WTK_SLIDER_CMD_RELEASE</a>,
<a name="l00293"></a>00293                         (<a class="code" href="group__gfx__win.html#ga53f0ed533fce454af67e765764d7eb5f" title="Custom data, can be used as a data pointer or data depending on the application.">win_command_t</a>)<a class="code" href="group__app__widget__group.html#ggacf97ed0c95e3bddca7bbf304bde08d33afc8f638e3da90e7668c344b40153b6c4" title="Event command ID for the slider.">SLIDER_ID</a>);
<a name="l00294"></a>00294         <span class="keywordflow">if</span> (!slider) {
<a name="l00295"></a>00295                 <span class="keywordflow">goto</span> error_widget;
<a name="l00296"></a>00296         }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298         <span class="comment">// Draw the slider by showing the slider widget&#39;s window.</span>
<a name="l00299"></a>00299         <a class="code" href="group__gfx__win.html#gacf174cc778747a982b36cbe05e0d247d" title="Show window. Will draw it on screen if parent is visible as well.">win_show</a>(<a class="code" href="group__gfx__wtk__slider.html#ga7955edfc3a1e4fd85e155949189a9c35" title="Get pointer to slider window.">wtk_slider_as_child</a>(slider));
<a name="l00300"></a>00300 
<a name="l00301"></a>00301         <span class="comment">// Application progress bar, placed right of the slider.</span>
<a name="l00302"></a>00302         area.pos.x += area.size.x + <a class="code" href="group__app__widget__group.html#ga4fa02143768ea5bca99c4d220e5b6fff" title="Spacing from slider to progress bar.">SLIDER_PB_SPACING_X</a>;
<a name="l00303"></a>00303         area.size.x = <a class="code" href="group__app__widget__group.html#ga40e2939dae3808c9ad5fccc968fcba49" title="Slider progress bar on display.">PB_SIZE_X</a>;
<a name="l00304"></a>00304         area.size.y = <a class="code" href="group__app__widget__group.html#ga7778bd242cc3e4b3995498b0c1d9fad3" title="Slider progress bar on display.">PB_SIZE_Y</a>;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306         <span class="comment">/*</span>
<a name="l00307"></a>00307 <span class="comment">         * Create the progress bar and check the return value if an error</span>
<a name="l00308"></a>00308 <span class="comment">         * occured while creating the progress bar.</span>
<a name="l00309"></a>00309 <span class="comment">         */</span>
<a name="l00310"></a>00310         progress_bar = <a class="code" href="group__gfx__wtk__progress__bar.html#ga3b925edcf34ed73651f04299a8cd0df2" title="Create a new progress bar widget.">wtk_progress_bar_create</a>(parent, &amp;area, <a class="code" href="group__app__widget__group.html#ga4991bdb8315f462d6f92813a04a36f1d" title="Max value for slider.">SLIDER_MAX_VALUE</a>,
<a name="l00311"></a>00311                         <a class="code" href="group__app__widget__group.html#ga4991bdb8315f462d6f92813a04a36f1d" title="Max value for slider.">SLIDER_MAX_VALUE</a> / 2, <a class="code" href="group__gfx__gfx.html#ga211e684859b29d9a8a5943d1498d533c" title="Generate a display-native color value from constant RGB components.">GFX_COLOR</a>(255, 255, 0),
<a name="l00312"></a>00312                         <a class="code" href="group__gfx__gfx.html#ga211e684859b29d9a8a5943d1498d533c" title="Generate a display-native color value from constant RGB components.">GFX_COLOR</a>(90, 90, 90), <a class="code" href="group__gfx__wtk__progress__bar__options.html#ga904c3253131536cc071c53e78d66517a" title="Progress bar is horizontally oriented.">WTK_PROGRESS_BAR_HORIZONTAL</a>);
<a name="l00313"></a>00313         <span class="keywordflow">if</span> (!progress_bar) {
<a name="l00314"></a>00314                 <span class="keywordflow">goto</span> error_widget;
<a name="l00315"></a>00315         }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317         <span class="comment">// Draw the progress bar by showing the progress bar widget&#39;s window.</span>
<a name="l00318"></a>00318         <a class="code" href="group__gfx__win.html#gacf174cc778747a982b36cbe05e0d247d" title="Show window. Will draw it on screen if parent is visible as well.">win_show</a>(<a class="code" href="group__gfx__wtk__progress__bar.html#gafcf4eb0256b04636cec97f7b084371fd" title="Get pointer to progress bar window.">wtk_progress_bar_as_child</a>(progress_bar));
<a name="l00319"></a>00319 
<a name="l00321"></a>00321         area.pos.x = 10;
<a name="l00322"></a>00322         area.pos.y = 150;
<a name="l00323"></a>00323         area.size.x = 90;
<a name="l00324"></a>00324         area.size.y = 40;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326         btn = <a class="code" href="group__gfx__wtk__button.html#gaebe80c65856294eab28bb29264e2bd64">wtk_button_create</a>(parent, &amp;area, <span class="stringliteral">&quot;Click&quot;</span>,
<a name="l00327"></a>00327                         (<a class="code" href="group__gfx__win.html#ga53f0ed533fce454af67e765764d7eb5f" title="Custom data, can be used as a data pointer or data depending on the application.">win_command_t</a>)<a class="code" href="group__app__widget__group.html#ggacf97ed0c95e3bddca7bbf304bde08d33ac5a68bc932e0a7936aa57c271d49d855" title="Event command ID for the button.">BUTTON_ID</a>);
<a name="l00328"></a>00328         <span class="keywordflow">if</span> (!btn) {
<a name="l00329"></a>00329                 <span class="keywordflow">goto</span> error_widget;
<a name="l00330"></a>00330         }
<a name="l00331"></a>00331         <a class="code" href="group__gfx__win.html#gacf174cc778747a982b36cbe05e0d247d" title="Show window. Will draw it on screen if parent is visible as well.">win_show</a>(<a class="code" href="group__gfx__wtk__button.html#ga5fc0cc848622a1e21f00648be089ae63">wtk_button_as_child</a>(btn));
<a name="l00332"></a>00332 
<a name="l00334"></a>00334         area.pos.x += area.size.x + 40;
<a name="l00335"></a>00335 
<a name="l00336"></a>00336         <a class="code" href="group__app__widget__group.html#ga45db49ed3dce8f348dea86573f0c5552" title="Sub-frame background bitmap.">sub_frame_background</a>.<a class="code" href="structgfx__bitmap.html#a25e3747161bb4053f91cbaab6bdc216d" title="Bitmap type.">type</a> = <a class="code" href="group__gfx__gfx.html#ggaaa3d242c7c08ccafbb00bbcfabe27e3fa5347f7bf0548ae0c3cc8210f49b937a6" title="Solid color bitmap.">BITMAP_SOLID</a>;
<a name="l00337"></a>00337         <a class="code" href="group__app__widget__group.html#ga45db49ed3dce8f348dea86573f0c5552" title="Sub-frame background bitmap.">sub_frame_background</a>.data.<a class="code" href="structgfx__bitmap.html#a79b389912a0bf990d9c23e8b21f02569" title="Color for solid color bitmaps.">color</a> = <a class="code" href="group__gfx__gfx.html#ga211e684859b29d9a8a5943d1498d533c" title="Generate a display-native color value from constant RGB components.">GFX_COLOR</a>(127, 0, 0);
<a name="l00338"></a>00338 
<a name="l00339"></a>00339         sub_frame = <a class="code" href="group__gfx__wtk__basic__frame.html#ga2ef82bf721f8db8440ef4bdaa5e9a982" title="Create basic frame widget.">wtk_basic_frame_create</a>(parent, &amp;area,
<a name="l00340"></a>00340                         &amp;<a class="code" href="group__app__widget__group.html#ga45db49ed3dce8f348dea86573f0c5552" title="Sub-frame background bitmap.">sub_frame_background</a>, <a class="code" href="group__app__widget__group.html#ga6201d3818c7546dcadec254eb3bc03ac" title="Frame draw event handler.">sub_frame_draw_handler</a>,
<a name="l00341"></a>00341                         NULL, NULL);
<a name="l00342"></a>00342         <span class="keywordflow">if</span> (!sub_frame) {
<a name="l00343"></a>00343                 <span class="keywordflow">goto</span> error_widget;
<a name="l00344"></a>00344         }
<a name="l00345"></a>00345         <a class="code" href="group__gfx__win.html#gacf174cc778747a982b36cbe05e0d247d" title="Show window. Will draw it on screen if parent is visible as well.">win_show</a>(<a class="code" href="group__gfx__wtk__basic__frame.html#ga288ea10860d82def003800b19222ab0c" title="Get reference to basic frame window.">wtk_basic_frame_as_child</a>(sub_frame));
<a name="l00346"></a>00346 
<a name="l00347"></a>00347         <span class="keywordflow">return</span>;
<a name="l00348"></a>00348 
<a name="l00349"></a>00349 error_widget:
<a name="l00350"></a>00350         <span class="comment">// Destroy widget and all sub-widgets.</span>
<a name="l00351"></a>00351         <a class="code" href="group__gfx__win.html#ga518fd778a7f6c3b7ae2e296e074e743f" title="Destroy a window and its contents including children, freeing up memory.">win_destroy</a>(<a class="code" href="group__gfx__wtk__basic__frame.html#ga288ea10860d82def003800b19222ab0c" title="Get reference to basic frame window.">wtk_basic_frame_as_child</a>(frame));
<a name="l00352"></a>00352 error_frame:
<a name="l00353"></a>00353         <span class="comment">// Wait forever if an error occured during setup.</span>
<a name="l00354"></a>00354         <span class="keywordflow">while</span>(1);
<a name="l00355"></a>00355 }
<a name="l00356"></a>00356 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Apr 29 15:18:21 2010 for display-training by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
