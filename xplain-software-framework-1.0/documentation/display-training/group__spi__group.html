<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>display-training: Serial Peripheral Interface (SPI)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Serial Peripheral Interface (SPI)</h1>
<p><div class="dynheader">
Collaboration diagram for Serial Peripheral Interface (SPI):</div>
<div class="dynsection">
<center><table><tr><td><img src="group__spi__group.png" border="0" alt="" usemap="#group____spi____group_map"/>
<map name="group____spi____group_map" id="group____spi____group">
<area shape="rect" href="group__spi__polled__internal__group.html" title="Generic SPI polled internals" alt="" coords="259,5,443,35"/></map></td></tr></table></center>
</div>
</p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structspi__master.html">spi_master</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SPI master.  <a href="structspi__master.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__polled__internal__group.html">Generic SPI polled internals</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga49e8927a636f45641d6231ac63b9e598">SPI_CPHA</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock phase.  <a href="#ga49e8927a636f45641d6231ac63b9e598"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#gad8e335b1f808bd7408d2aef2377adcb1">SPI_CPOL</a>&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock polarity.  <a href="#gad8e335b1f808bd7408d2aef2377adcb1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga1ec07ad94d5f6276c1c0b41d0550fe52">SPI_MODE_0</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SPI mode 0.  <a href="#ga1ec07ad94d5f6276c1c0b41d0550fe52"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#gaf2af9f45539491c9753960535dc20fde">SPI_MODE_1</a>&nbsp;&nbsp;&nbsp;(SPI_CPHA)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SPI mode 1.  <a href="#gaf2af9f45539491c9753960535dc20fde"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga8fa3edd8616f8803490c93f09243a612">SPI_MODE_2</a>&nbsp;&nbsp;&nbsp;(SPI_CPOL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SPI mode 2.  <a href="#ga8fa3edd8616f8803490c93f09243a612"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga6a091da9f9011457fe28ab25f64c858d">SPI_MODE_3</a>&nbsp;&nbsp;&nbsp;(SPI_CPOL | SPI_CPHA)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SPI mode 3.  <a href="#ga6a091da9f9011457fe28ab25f64c858d"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#gad196c30f1762eff53760d86bbddad9aa">spi_request_bus</a> (struct <a class="el" href="structspi__master.html">spi_master</a> *master, struct <a class="el" href="structworkqueue__task.html">workqueue_task</a> *task)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Request use of SPI bus.  <a href="#gad196c30f1762eff53760d86bbddad9aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga080f752ad66ac1d207cc869c828e13c6">spi_release_bus</a> (struct <a class="el" href="structspi__master.html">spi_master</a> *master)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release use of SPI bus.  <a href="#ga080f752ad66ac1d207cc869c828e13c6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#gac828b494f3749583554b8f974497fec3">spi_enable</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable SPI module.  <a href="#gac828b494f3749583554b8f974497fec3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga1d74d0392be7db060fad2d72a256d009">spi_disable</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable SPI module.  <a href="#ga1d74d0392be7db060fad2d72a256d009"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga767870986d7e09d65fbf7472f0c3dbfb">spi_is_enabled</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if SPI module is enabled.  <a href="#ga767870986d7e09d65fbf7472f0c3dbfb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga328a23529029373191d5fc4006e8dfcb">spi_master_init</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *<a class="el" href="structspi__master.html">spi_master</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize SPI module in master mode.  <a href="#ga328a23529029373191d5fc4006e8dfcb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga885cd9c7fdbbac2c147d439caa37df84">spi_master_setup_device</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *<a class="el" href="structspi__master.html">spi_master</a>, struct <a class="el" href="structspi__device.html">spi_device</a> *<a class="el" href="structspi__device.html">spi_device</a>, <a class="el" href="group__spi__xmega__internal__group.html#ga781db101a4c4490735eb12d3cb92fde7">spi_flags_t</a> flags, unsigned long baud_rate, <a class="el" href="board_2xplain_2include_2board_2spi_8h.html#a2b0fdae4392e5ea70eb2c238bdf1feb4">board_spi_select_id_t</a> sel_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Setup a SPI device.  <a href="#ga885cd9c7fdbbac2c147d439caa37df84"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#gabedc3a32fd102976a04e91c90ff61021">spi_select_device</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *master, struct <a class="el" href="structspi__device.html">spi_device</a> *device)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Select given device on the SPI bus.  <a href="#gabedc3a32fd102976a04e91c90ff61021"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#gafa781b82d01b3f8aacc1dcb97ba99e76">spi_deselect_device</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *master, struct <a class="el" href="structspi__device.html">spi_device</a> *device)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deselect given device on the SPI bus.  <a href="#gafa781b82d01b3f8aacc1dcb97ba99e76"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#gab8e1df9f3a51cc26bff61f9b11067971">spi_write</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *master, const <a class="el" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *data, size_t len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a sequence of bytes to a SPI device.  <a href="#gab8e1df9f3a51cc26bff61f9b11067971"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga5c1c808de03e6c27004b6fb186c30575">spi_read</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *master, <a class="el" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *data, size_t len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive a sequence of bytes from a SPI device.  <a href="#ga5c1c808de03e6c27004b6fb186c30575"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga0d5712e90d9184b4ff743361020fbf7c">spi_exchange</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *master, const <a class="el" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *write, <a class="el" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *read, size_t len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send/Receive a sequence of bytes to/from a SPI device.  <a href="#ga0d5712e90d9184b4ff743361020fbf7c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga65d1094f0d0fe8d9cc98edb30184b7d2">spi_write_buf_list</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *master, struct <a class="el" href="structslist.html">slist</a> *buf_list)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send bytes from a list of buffers to a SPI device.  <a href="#ga65d1094f0d0fe8d9cc98edb30184b7d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#gad5742f5830a98948d82a319493ec7567">spi_read_buf_list</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *master, struct <a class="el" href="structslist.html">slist</a> *buf_list)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive bytes into a list of buffers from a SPI device.  <a href="#gad5742f5830a98948d82a319493ec7567"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spi__group.html#ga4f88493bc81159009cfe69580728ba1a">spi_exchange_buf_list</a> (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a> spi_id, struct <a class="el" href="structspi__master.html">spi_master</a> *master, struct <a class="el" href="structslist.html">slist</a> *write_buf_list, struct <a class="el" href="structslist.html">slist</a> *read_buf_list)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send/Receive a list of buffers to/from a SPI device.  <a href="#ga4f88493bc81159009cfe69580728ba1a"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This is the common API for SPIs on AVRs. Additional features are available in the documentation of the specific modules.</p>
<p>An <a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> starts with 0 which stands for the first available SPI module on the device and the next SPI modules get increasing numbers. After the "standard" SPI modules the emulated versions are listed (e.g. USART in SPI mode or USI in SPI mode).</p>
<p>To add the SPI master driver to the build, the configuration symbol CONFIG_SPI_MASTER must be set.</p>
<p>The symbols CONFIG_SPI_MASTER_INT or CONFIG_SPI_MASTER_DMA enable interrupt or DMA driven communication for the SPI master, if available on the device.</p>
<h2><a class="anchor" id="spi_modes_section">
SPI modes</a></h2>
<p>There are four combinations of serial clock phase and polarity with respect to serial data. The table below shows the combinations and when data is sampled or set up. The leading edge is the first clock edge in a clock cycle. Trailing edge is the last clock edge in a clock cycle.</p>
<table class="doxtable">
<tr>
<th>SPI Mode </th><th>CPOL </th><th>CPHA </th><th>Leading Edge </th><th>Trailing Edge  </th></tr>
<tr>
<td>0 </td><td>0 </td><td>0 </td><td>Sample on rising edge </td><td>Setup on falling edge  </td></tr>
<tr>
<td>1 </td><td>0 </td><td>1 </td><td>Setup on rising edge </td><td>Sample on falling edge  </td></tr>
<tr>
<td>2 </td><td>1 </td><td>0 </td><td>Sample on falling edge </td><td>Setup on rising edge  </td></tr>
<tr>
<td>3 </td><td>1 </td><td>1 </td><td>Setup on falling edge </td><td>Sample on rising edge  </td></tr>
</table>
<h2><a class="anchor" id="spi_poll_loop_group">
SPI poll loops</a></h2>
<p>The internals of this SPI driver uses polling from a <a class="el" href="structworkqueue__task.html" title="Task to be run from a work queue.">workqueue_task</a>, and this can be controlled with the configuration symbol CONFIG_SPI_POLL_MAXLOOPS</p>
<p>If unconfigured, the default value is 255</p>
<h2><a class="anchor" id="spi_module_id">
SPI Module ID</a></h2>
<p>Overview of mapping between SPI module id (<a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>) and peripheral:</p>
<ul>
<li>ID 0: SPI on PORTC</li>
<li>ID 1: SPI on PORTD</li>
<li>ID 2: SPI on PORTE</li>
<li>ID 3: SPI on PORTF</li>
<li>ID 4: USART 0 on PORTC in SPI mode</li>
<li>ID 5: USART 1 on PORTC in SPI mode</li>
<li>ID 6: USART 0 on PORTD in SPI mode</li>
<li>ID 7: USART 1 on PORTD in SPI mode</li>
<li>ID 8: USART 0 on PORTE in SPI mode</li>
<li>ID 9: USART 1 on PORTE in SPI mode</li>
<li>ID 10: USART 0 on PORTF in SPI mode</li>
<li>ID 11: USART 1 on PORTF in SPI mode </li>
</ul>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga49e8927a636f45641d6231ac63b9e598"></a><!-- doxytag: member="spi.h::SPI_CPHA" ref="ga49e8927a636f45641d6231ac63b9e598" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPI_CPHA&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clock phase. </p>

<p>Definition at line <a class="el" href="include_2spi_8h_source.html#l00114">114</a> of file <a class="el" href="include_2spi_8h_source.html">spi.h</a>.</p>

</div>
</div>
<a class="anchor" id="gad8e335b1f808bd7408d2aef2377adcb1"></a><!-- doxytag: member="spi.h::SPI_CPOL" ref="gad8e335b1f808bd7408d2aef2377adcb1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPI_CPOL&nbsp;&nbsp;&nbsp;(1 &lt;&lt; 1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clock polarity. </p>

<p>Definition at line <a class="el" href="include_2spi_8h_source.html#l00119">119</a> of file <a class="el" href="include_2spi_8h_source.html">spi.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga1ec07ad94d5f6276c1c0b41d0550fe52"></a><!-- doxytag: member="spi.h::SPI_MODE_0" ref="ga1ec07ad94d5f6276c1c0b41d0550fe52" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPI_MODE_0&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SPI mode 0. </p>

<p>Definition at line <a class="el" href="include_2spi_8h_source.html#l00124">124</a> of file <a class="el" href="include_2spi_8h_source.html">spi.h</a>.</p>

</div>
</div>
<a class="anchor" id="gaf2af9f45539491c9753960535dc20fde"></a><!-- doxytag: member="spi.h::SPI_MODE_1" ref="gaf2af9f45539491c9753960535dc20fde" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPI_MODE_1&nbsp;&nbsp;&nbsp;(SPI_CPHA)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SPI mode 1. </p>

<p>Definition at line <a class="el" href="include_2spi_8h_source.html#l00128">128</a> of file <a class="el" href="include_2spi_8h_source.html">spi.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga8fa3edd8616f8803490c93f09243a612"></a><!-- doxytag: member="spi.h::SPI_MODE_2" ref="ga8fa3edd8616f8803490c93f09243a612" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPI_MODE_2&nbsp;&nbsp;&nbsp;(SPI_CPOL)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SPI mode 2. </p>

<p>Definition at line <a class="el" href="include_2spi_8h_source.html#l00132">132</a> of file <a class="el" href="include_2spi_8h_source.html">spi.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga6a091da9f9011457fe28ab25f64c858d"></a><!-- doxytag: member="spi.h::SPI_MODE_3" ref="ga6a091da9f9011457fe28ab25f64c858d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPI_MODE_3&nbsp;&nbsp;&nbsp;(SPI_CPOL | SPI_CPHA)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SPI mode 3. </p>

<p>Definition at line <a class="el" href="include_2spi_8h_source.html#l00136">136</a> of file <a class="el" href="include_2spi_8h_source.html">spi.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gafa781b82d01b3f8aacc1dcb97ba99e76"></a><!-- doxytag: member="spi_mega_xmega.h::spi_deselect_device" ref="gafa781b82d01b3f8aacc1dcb97ba99e76" args="(spi_id_t spi_id, struct spi_master *master, struct spi_device *device)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_deselect_device </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__device.html">spi_device</a> *&nbsp;</td>
          <td class="paramname"> <em>device</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deselect given device on the SPI bus. </p>
<p>Calls board chip deselect.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>SPI device</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>This must only be used in workqueue task issued by driver </dd>
<dd>
SPI device must be selected with <a class="el" href="group__spi__group.html#gabedc3a32fd102976a04e91c90ff61021" title="Select given device on the SPI bus.">spi_select_device()</a> first </dd></dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00418">418</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__mega__xmega__internal__group.html#gabfe0503428169df266243cc786c8fe3f">spi_priv_deselect_device()</a>.</p>

<p>Referenced by <a class="el" href="at45__device_8h_source.html#l00150">at45_deselect()</a>.</p>

</div>
</div>
<a class="anchor" id="ga1d74d0392be7db060fad2d72a256d009"></a><!-- doxytag: member="spi_mega_xmega.h::spi_disable" ref="ga1d74d0392be7db060fad2d72a256d009" args="(spi_id_t spi_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_disable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Disable SPI module. </p>
<p>The SPI is only disabled when it is not used any more. This is ensured by an internal counter that is decreased each time this function is called.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00373">373</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="assert_8h_source.html#l00089">assert</a>, <a class="el" href="spi__mega__xmega_8h_source.html#l00232">spi_id_is_valid</a>, and <a class="el" href="spi__xmega_8h_source.html#l00104">spi_priv_disable()</a>.</p>

</div>
</div>
<a class="anchor" id="gac828b494f3749583554b8f974497fec3"></a><!-- doxytag: member="spi_mega_xmega.h::spi_enable" ref="gac828b494f3749583554b8f974497fec3" args="(spi_id_t spi_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_enable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enable SPI module. </p>
<p>The driver keeps a reference count that is increased each time this function is called.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00364">364</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="assert_8h_source.html#l00089">assert</a>, <a class="el" href="spi__mega__xmega_8h_source.html#l00232">spi_id_is_valid</a>, and <a class="el" href="spi__xmega_8h_source.html#l00098">spi_priv_enable()</a>.</p>

</div>
</div>
<a class="anchor" id="ga0d5712e90d9184b4ff743361020fbf7c"></a><!-- doxytag: member="spi_mega_xmega.h::spi_exchange" ref="ga0d5712e90d9184b4ff743361020fbf7c" args="(spi_id_t spi_id, struct spi_master *master, const uint8_t *write, uint8_t *read, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send/Receive a sequence of bytes to/from a SPI device. </p>
<p>Send bytes from <em>write</em> buffer and receive bytes into <em>read</em> buffer. Length field <em>len</em> are common for both.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>write</em>&nbsp;</td><td>data buffer to write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>read</em>&nbsp;</td><td>data buffer to read </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Length of data</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>This must only be used in workqueue task issued by driver </dd>
<dd>
SPI device must be selected with <a class="el" href="group__spi__group.html#gabedc3a32fd102976a04e91c90ff61021" title="Select given device on the SPI bus.">spi_select_device()</a> first </dd></dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00438">438</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__polled__internal__group.html#ga5d4a08f4f177344394741ba229e91326">spi_polled_exchange()</a>.</p>

</div>
</div>
<a class="anchor" id="ga4f88493bc81159009cfe69580728ba1a"></a><!-- doxytag: member="spi_mega_xmega.h::spi_exchange_buf_list" ref="ga4f88493bc81159009cfe69580728ba1a" args="(spi_id_t spi_id, struct spi_master *master, struct slist *write_buf_list, struct slist *read_buf_list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_exchange_buf_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structslist.html">slist</a> *&nbsp;</td>
          <td class="paramname"> <em>write_buf_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structslist.html">slist</a> *&nbsp;</td>
          <td class="paramname"> <em>read_buf_list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send/Receive a list of buffers to/from a SPI device. </p>
<p>Buffer lists must be symetrical in the sense of number of buffers and buffer sizes.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>write_buf_list</em>&nbsp;</td><td>List of buffers to send from </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>read_buf_list</em>&nbsp;</td><td>List of buffers to receive into</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>This must only be used in workqueue task issued by driver </dd>
<dd>
SPI device must be selected with <a class="el" href="group__spi__group.html#gabedc3a32fd102976a04e91c90ff61021" title="Select given device on the SPI bus.">spi_select_device()</a> first </dd></dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00456">456</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__polled__internal__group.html#ga2279b032712b6c5f50d0309ede7013c0">spi_polled_exchange_buf_list()</a>.</p>

</div>
</div>
<a class="anchor" id="ga767870986d7e09d65fbf7472f0c3dbfb"></a><!-- doxytag: member="spi_mega_xmega.h::spi_is_enabled" ref="ga767870986d7e09d65fbf7472f0c3dbfb" args="(spi_id_t spi_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spi_is_enabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check if SPI module is enabled. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00382">382</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="assert_8h_source.html#l00089">assert</a>, <a class="el" href="spi__mega__xmega_8h_source.html#l00232">spi_id_is_valid</a>, and <a class="el" href="spi__xmega_8h_source.html#l00110">spi_priv_is_enabled()</a>.</p>

</div>
</div>
<a class="anchor" id="ga328a23529029373191d5fc4006e8dfcb"></a><!-- doxytag: member="spi_mega_xmega.h::spi_master_init" ref="ga328a23529029373191d5fc4006e8dfcb" args="(spi_id_t spi_id, struct spi_master *spi_master)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_master_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize SPI module in master mode. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>Pointer to SPI master struct. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00391">391</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__mega__xmega__internal__group.html#gaca8f508d7a0052618f5f2059e4f0e9b6">spi_priv_master_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ga885cd9c7fdbbac2c147d439caa37df84"></a><!-- doxytag: member="spi_mega_xmega.h::spi_master_setup_device" ref="ga885cd9c7fdbbac2c147d439caa37df84" args="(spi_id_t spi_id, struct spi_master *spi_master, struct spi_device *spi_device, spi_flags_t flags, unsigned long baud_rate, board_spi_select_id_t sel_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_master_setup_device </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__device.html">spi_device</a> *&nbsp;</td>
          <td class="paramname"> <em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga781db101a4c4490735eb12d3cb92fde7">spi_flags_t</a>&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>baud_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="board_2xplain_2include_2board_2spi_8h.html#a2b0fdae4392e5ea70eb2c238bdf1feb4">board_spi_select_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>sel_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Setup a SPI device. </p>
<p>The returned device descriptor structure must be passed to the driver whenever that device should be used as current slave device.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>Pointer to SPI master structure. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>Pointer to SPI device struct that should be initialized. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>SPI configuration flags. Common flags for all implementations are the SPI modes SPI_MODE_0 ... SPI_MODE_3. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>baud_rate</em>&nbsp;</td><td>Baud rate for communication with slave device in Hz. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sel_id</em>&nbsp;</td><td>Board specific seclet id </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00399">399</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__mega__xmega__internal__group.html#ga0a87144e120106f3a590f7d830c85016">spi_priv_master_setup_device()</a>.</p>

</div>
</div>
<a class="anchor" id="ga5c1c808de03e6c27004b6fb186c30575"></a><!-- doxytag: member="spi_mega_xmega.h::spi_read" ref="ga5c1c808de03e6c27004b6fb186c30575" args="(spi_id_t spi_id, struct spi_master *master, uint8_t *data, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Receive a sequence of bytes from a SPI device. </p>
<p>All bytes sent out on SPI bus are sent as value 0.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data buffer to read </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Length of data</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>This must only be used in workqueue task issued by driver </dd>
<dd>
SPI device must be selected with <a class="el" href="group__spi__group.html#gabedc3a32fd102976a04e91c90ff61021" title="Select given device on the SPI bus.">spi_select_device()</a> first </dd></dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00432">432</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__polled__internal__group.html#ga0e843b724dd93a32b9adae509fc6d32f">spi_polled_read()</a>.</p>

<p>Referenced by <a class="el" href="at45__device_8h_source.html#l00186">at45_read_rsp()</a>.</p>

</div>
</div>
<a class="anchor" id="gad5742f5830a98948d82a319493ec7567"></a><!-- doxytag: member="spi_mega_xmega.h::spi_read_buf_list" ref="gad5742f5830a98948d82a319493ec7567" args="(spi_id_t spi_id, struct spi_master *master, struct slist *buf_list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_read_buf_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structslist.html">slist</a> *&nbsp;</td>
          <td class="paramname"> <em>buf_list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Receive bytes into a list of buffers from a SPI device. </p>
<p>All bytes sent out on SPI bus are sent as value 0.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf_list</em>&nbsp;</td><td>List of buffers to receive into</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>This must only be used in workqueue task issued by driver </dd>
<dd>
SPI device must be selected with <a class="el" href="group__spi__group.html#gabedc3a32fd102976a04e91c90ff61021" title="Select given device on the SPI bus.">spi_select_device()</a> first </dd></dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00450">450</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__polled__internal__group.html#ga76c72ead3f948b525f99ae12e6cccdf3">spi_polled_read_buf_list()</a>.</p>

<p>Referenced by <a class="el" href="at45__device_8h_source.html#l00314">at45_read_buf_list()</a>.</p>

</div>
</div>
<a class="anchor" id="ga080f752ad66ac1d207cc869c828e13c6"></a><!-- doxytag: member="spi.h::spi_release_bus" ref="ga080f752ad66ac1d207cc869c828e13c6" args="(struct spi_master *master)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void spi_release_bus </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release use of SPI bus. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>This must only be used in workqueue task issued by driver </dd></dl>

<p>Definition at line <a class="el" href="include_2spi_8h_source.html#l00236">236</a> of file <a class="el" href="include_2spi_8h_source.html">spi.h</a>.</p>

<p>References <a class="el" href="group__workqueue__group.html#gaace01054e8c6e9b4af76c58913c7a552">nested_workqueue_next_task()</a>, and <a class="el" href="include_2spi_8h_source.html#l00146">spi_master::nwq</a>.</p>

<p>Referenced by <a class="el" href="at45__device_8h_source.html#l00126">at45_release()</a>.</p>

</div>
</div>
<a class="anchor" id="gad196c30f1762eff53760d86bbddad9aa"></a><!-- doxytag: member="spi.h::spi_request_bus" ref="gad196c30f1762eff53760d86bbddad9aa" args="(struct spi_master *master, struct workqueue_task *task)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool spi_request_bus </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structworkqueue__task.html">workqueue_task</a> *&nbsp;</td>
          <td class="paramname"> <em>task</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Request use of SPI bus. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>task</em>&nbsp;</td><td>Task doing the SPI bus operations</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>The task was successfully queued </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>The task has already been queued, so nothing was done </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="include_2spi_8h_source.html#l00223">223</a> of file <a class="el" href="include_2spi_8h_source.html">spi.h</a>.</p>

<p>References <a class="el" href="group__workqueue__group.html#gadd38acc207e3bfb0e8c17a59a7b875ba">nested_workqueue_add_task()</a>, and <a class="el" href="include_2spi_8h_source.html#l00146">spi_master::nwq</a>.</p>

<p>Referenced by <a class="el" href="at45__device_8h_source.html#l00113">at45_request()</a>.</p>

</div>
</div>
<a class="anchor" id="gabedc3a32fd102976a04e91c90ff61021"></a><!-- doxytag: member="spi_mega_xmega.h::spi_select_device" ref="gabedc3a32fd102976a04e91c90ff61021" args="(spi_id_t spi_id, struct spi_master *master, struct spi_device *device)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_select_device </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__device.html">spi_device</a> *&nbsp;</td>
          <td class="paramname"> <em>device</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Select given device on the SPI bus. </p>
<p>Set device specific setting and calls board chip select.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>device</em>&nbsp;</td><td>SPI device</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>This must only be used in workqueue task issued by driver </dd></dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00410">410</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__mega__xmega__internal__group.html#gad4a6a264b2a801b45318c296edd89492">spi_priv_select_device()</a>.</p>

<p>Referenced by <a class="el" href="at45__device_8h_source.html#l00138">at45_select()</a>.</p>

</div>
</div>
<a class="anchor" id="gab8e1df9f3a51cc26bff61f9b11067971"></a><!-- doxytag: member="spi_mega_xmega.h::spi_write" ref="gab8e1df9f3a51cc26bff61f9b11067971" args="(spi_id_t spi_id, struct spi_master *master, const uint8_t *data, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2">uint8_t</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send a sequence of bytes to a SPI device. </p>
<p>Received bytes on the SPI bus are discarded.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data buffer to write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>Length of data</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>This must only be used in workqueue task issued by driver </dd>
<dd>
SPI device must be selected with <a class="el" href="group__spi__group.html#gabedc3a32fd102976a04e91c90ff61021" title="Select given device on the SPI bus.">spi_select_device()</a> first </dd></dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00426">426</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__polled__internal__group.html#ga36da98c10e6d372804b6d90c8bda7de2">spi_polled_write()</a>.</p>

<p>Referenced by <a class="el" href="at45__device_8h_source.html#l00167">at45_write_cmd()</a>.</p>

</div>
</div>
<a class="anchor" id="ga65d1094f0d0fe8d9cc98edb30184b7d2"></a><!-- doxytag: member="spi_mega_xmega.h::spi_write_buf_list" ref="ga65d1094f0d0fe8d9cc98edb30184b7d2" args="(spi_id_t spi_id, struct spi_master *master, struct slist *buf_list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_write_buf_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__spi__xmega__internal__group.html#ga59eca0ea1cb53b57e414dbadee990e1e">spi_id_t</a>&nbsp;</td>
          <td class="paramname"> <em>spi_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structspi__master.html">spi_master</a> *&nbsp;</td>
          <td class="paramname"> <em>master</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structslist.html">slist</a> *&nbsp;</td>
          <td class="paramname"> <em>buf_list</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send bytes from a list of buffers to a SPI device. </p>
<p>Received bytes on the SPI bus are discarded.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>spi_id</em>&nbsp;</td><td><a class="el" href="group__spi__group.html#spi_module_id">SPI Module ID</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master</em>&nbsp;</td><td>SPI master </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf_list</em>&nbsp;</td><td>List of buffers send from</td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>This must only be used in workqueue task issued by driver </dd>
<dd>
SPI device must be selected with <a class="el" href="group__spi__group.html#gabedc3a32fd102976a04e91c90ff61021" title="Select given device on the SPI bus.">spi_select_device()</a> first </dd></dl>

<p>Definition at line <a class="el" href="spi__mega__xmega_8h_source.html#l00444">444</a> of file <a class="el" href="spi__mega__xmega_8h_source.html">spi_mega_xmega.h</a>.</p>

<p>References <a class="el" href="group__spi__polled__internal__group.html#ga3b272ca277292b2c98c81289b3f17f1d">spi_polled_write_buf_list()</a>.</p>

<p>Referenced by <a class="el" href="at45__device_8h_source.html#l00328">at45_write_buf_list()</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Apr 29 15:18:24 2010 for display-training by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
