<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>display-training: Board RAM control</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Board RAM control</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__board__ram__group.html#ga80090e283a75cbdc5dfd27a1c52960de">BOARD_SDRAM_INITDLY</a>&nbsp;&nbsp;&nbsp;(100 * 2 * CONFIG_CPU_HZ / 1000000)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SDRAM initialization delay in number of CLKper2 cycles (100 us).  <a href="#ga80090e283a75cbdc5dfd27a1c52960de"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__board__ram__group.html#ga9004e245e2483f846c7251bec2ff6033">BOARD_SDRAM_REFRESH</a>&nbsp;&nbsp;&nbsp;(16 * 2 * CONFIG_CPU_HZ / 1000000)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SDRAM refresh interval in number of CLKper2 cycles (16 us).  <a href="#ga9004e245e2483f846c7251bec2ff6033"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__board__ram__group.html#ga32d06757f14079ac6e2b7c7b64f8692c">board_enable_sdram</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Configure the EBI for the 8 MB onboard SDRAM.  <a href="#ga32d06757f14079ac6e2b7c7b64f8692c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__board__ram__group.html#ga92e3f3d606b2d03a269e8137b88e6556">board_disable_sdram</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable the SDRAM by disabling the EBI.  <a href="#ga92e3f3d606b2d03a269e8137b88e6556"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__board__ram__group.html#gae21c5ecbea0fba5a80020ea31d6802c4">board_enable_sdram_selfrefresh</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable self-refresh mode for SDRAM.  <a href="#gae21c5ecbea0fba5a80020ea31d6802c4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__board__ram__group.html#ga8d54f1fd3d17e829131e426f2d6d5702">board_disable_sdram_selfrefresh</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disable self-refresh mode for SDRAM.  <a href="#ga8d54f1fd3d17e829131e426f2d6d5702"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><b>For internal use only.</b></p>
<p>This module contains functions for initalizing the EBI for use with the Xplain's onboard SDRAM, as well as enabling/disabling SDRAM self-refresh mode upon XMEGA sleep/wake-up.</p>
<p>The initialization assumes that the symbol CONFIG_CPU_HZ is half of what CLKper2 is, i.e., the CPU clock is prescaled to half of CLKper2.</p>
<p>Further, the initialization requires CONFIG_EXTRAM_BASE and CONFIG_EXTRAM_END to be defined, which are also needed by the application for addressing the hugemem section (external RAM).</p>
<dl class="note"><dt><b>Note:</b></dt><dd>If CONFIG_EXTRAM_SDRAM is defined, the initialization is done in board_init().</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000022">Todo:</a></b></dt><dd>Remove dependency on CONFIG_CPU_HZ, implement sysclk_get_xxx_hz()</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000023">Todo:</a></b></dt><dd>Revisit when EBI driver for XMEGA is ready and this can be moved into include/bus/ebi/params.</dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga80090e283a75cbdc5dfd27a1c52960de"></a><!-- doxytag: member="sdram.h::BOARD_SDRAM_INITDLY" ref="ga80090e283a75cbdc5dfd27a1c52960de" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOARD_SDRAM_INITDLY&nbsp;&nbsp;&nbsp;(100 * 2 * CONFIG_CPU_HZ / 1000000)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SDRAM initialization delay in number of CLKper2 cycles (100 us). </p>

<p>Definition at line <a class="el" href="sdram_8h_source.html#l00075">75</a> of file <a class="el" href="sdram_8h_source.html">sdram.h</a>.</p>

<p>Referenced by <a class="el" href="sdram_8h_source.html#l00087">board_enable_sdram()</a>.</p>

</div>
</div>
<a class="anchor" id="ga9004e245e2483f846c7251bec2ff6033"></a><!-- doxytag: member="sdram.h::BOARD_SDRAM_REFRESH" ref="ga9004e245e2483f846c7251bec2ff6033" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOARD_SDRAM_REFRESH&nbsp;&nbsp;&nbsp;(16 * 2 * CONFIG_CPU_HZ / 1000000)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SDRAM refresh interval in number of CLKper2 cycles (16 us). </p>

<p>Definition at line <a class="el" href="sdram_8h_source.html#l00078">78</a> of file <a class="el" href="sdram_8h_source.html">sdram.h</a>.</p>

<p>Referenced by <a class="el" href="sdram_8h_source.html#l00087">board_enable_sdram()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga92e3f3d606b2d03a269e8137b88e6556"></a><!-- doxytag: member="sdram.h::board_disable_sdram" ref="ga92e3f3d606b2d03a269e8137b88e6556" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void board_disable_sdram </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Disable the SDRAM by disabling the EBI. </p>

<p>Definition at line <a class="el" href="sdram_8h_source.html#l00121">121</a> of file <a class="el" href="sdram_8h_source.html">sdram.h</a>.</p>

<p>References <a class="el" href="xmega__ebi_8h_source.html#l00209">EBI_BF</a>, <a class="el" href="xmega__ebi_8h_source.html#l00077">EBI_IFMODE_DISABLED</a>, <a class="el" href="xmega__ebi_8h_source.html#l00231">ebi_write_reg</a>, <a class="el" href="xmega__ebi_8h_source.html#l00347">EBICS_BF</a>, <a class="el" href="xmega__ebi_8h_source.html#l00289">EBICS_MODE_DISABLE</a>, <a class="el" href="xmega__ebi_8h_source.html#l00369">ebics_write_reg</a>, <a class="el" href="group__sysclk__group.html#ga0fae379b6a38fe79aaed24382f884029">sysclk_disable_module()</a>, <a class="el" href="sysclk_8h_source.html#l00073">SYSCLK_EBI</a>, and <a class="el" href="sysclk_8h_source.html#l00059">SYSCLK_PORT_GEN</a>.</p>

</div>
</div>
<a class="anchor" id="ga8d54f1fd3d17e829131e426f2d6d5702"></a><!-- doxytag: member="sdram.h::board_disable_sdram_selfrefresh" ref="ga8d54f1fd3d17e829131e426f2d6d5702" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void board_disable_sdram_selfrefresh </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Disable self-refresh mode for SDRAM. </p>
<p>Bring SDRAM out of self-refresh mode when the peripheral clock is enabled. This is needed to regain access. </p>

<p>Definition at line <a class="el" href="sdram_8h_source.html#l00159">159</a> of file <a class="el" href="sdram_8h_source.html">sdram.h</a>.</p>

<p>References <a class="el" href="arch_2avr8_2include_2arch_2interrupt_8h_source.html#l00069">cpu_irq_restore()</a>, <a class="el" href="arch_2avr8_2include_2arch_2interrupt_8h_source.html#l00055">cpu_irq_save()</a>, <a class="el" href="xmega__ebi_8h_source.html#l00344">EBICS_BIT</a>, <a class="el" href="xmega__ebi_8h_source.html#l00366">ebics_read_reg</a>, and <a class="el" href="xmega__ebi_8h_source.html#l00369">ebics_write_reg</a>.</p>

</div>
</div>
<a class="anchor" id="ga32d06757f14079ac6e2b7c7b64f8692c"></a><!-- doxytag: member="sdram.h::board_enable_sdram" ref="ga32d06757f14079ac6e2b7c7b64f8692c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void board_enable_sdram </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Configure the EBI for the 8 MB onboard SDRAM. </p>

<p>Definition at line <a class="el" href="sdram_8h_source.html#l00087">87</a> of file <a class="el" href="sdram_8h_source.html">sdram.h</a>.</p>

<p>References <a class="el" href="sdram_8h_source.html#l00075">BOARD_SDRAM_INITDLY</a>, <a class="el" href="sdram_8h_source.html#l00078">BOARD_SDRAM_REFRESH</a>, <a class="el" href="xmega__ebi_8h_source.html#l00209">EBI_BF</a>, <a class="el" href="xmega__ebi_8h_source.html#l00206">EBI_BIT</a>, <a class="el" href="xmega__ebi_8h_source.html#l00078">EBI_IFMODE_3PORT</a>, <a class="el" href="xmega__ebi_8h_source.html#l00118">EBI_SDCOL_10BIT</a>, <a class="el" href="xmega__ebi_8h_source.html#l00101">EBI_SDDATAW_4BIT</a>, <a class="el" href="xmega__ebi_8h_source.html#l00231">ebi_write_reg</a>, <a class="el" href="xmega__ebi_8h_source.html#l00245">ebi_write_word_reg</a>, <a class="el" href="xmega__ebi_8h_source.html#l00347">EBICS_BF</a>, <a class="el" href="xmega__ebi_8h_source.html#l00344">EBICS_BIT</a>, <a class="el" href="xmega__ebi_8h_source.html#l00292">EBICS_MODE_SDRAM</a>, <a class="el" href="xmega__ebi_8h_source.html#l00366">ebics_read_reg</a>, <a class="el" href="xmega__ebi_8h_source.html#l00313">EBICS_SDMODE_NORMAL</a>, <a class="el" href="xmega__ebi_8h_source.html#l00369">ebics_write_reg</a>, <a class="el" href="xmega__ebi_8h_source.html#l00385">ebics_write_word_reg</a>, <a class="el" href="util_8h_source.html#l00190">ilog2()</a>, <a class="el" href="sysclk_8h_source.html#l00073">SYSCLK_EBI</a>, <a class="el" href="group__sysclk__group.html#ga012b848a4e0d038e8e1d7432d0787554">sysclk_enable_module()</a>, and <a class="el" href="sysclk_8h_source.html#l00059">SYSCLK_PORT_GEN</a>.</p>

</div>
</div>
<a class="anchor" id="gae21c5ecbea0fba5a80020ea31d6802c4"></a><!-- doxytag: member="sdram.h::board_enable_sdram_selfrefresh" ref="gae21c5ecbea0fba5a80020ea31d6802c4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void board_enable_sdram_selfrefresh </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enable self-refresh mode for SDRAM. </p>
<p>Put SDRAM in self-refresh mode, leaving it inaccessible until this mode is disabled again. This is necessary for retaining its contents when the XMEGA is put in sleep modes where the peripheral clock is disabled. </p>

<p>Definition at line <a class="el" href="sdram_8h_source.html#l00139">139</a> of file <a class="el" href="sdram_8h_source.html">sdram.h</a>.</p>

<p>References <a class="el" href="arch_2avr8_2include_2arch_2interrupt_8h_source.html#l00069">cpu_irq_restore()</a>, <a class="el" href="arch_2avr8_2include_2arch_2interrupt_8h_source.html#l00055">cpu_irq_save()</a>, <a class="el" href="xmega__ebi_8h_source.html#l00344">EBICS_BIT</a>, <a class="el" href="xmega__ebi_8h_source.html#l00366">ebics_read_reg</a>, and <a class="el" href="xmega__ebi_8h_source.html#l00369">ebics_write_reg</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Apr 29 15:18:25 2010 for display-training by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
