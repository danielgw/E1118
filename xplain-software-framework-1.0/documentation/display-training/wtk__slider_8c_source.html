<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>display-training: util/gfx/wtk_slider.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>util/gfx/wtk_slider.c</h1><a href="wtk__slider_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="arch_2avr8_2include_2arch_2stdint_8h.html" title="C99 integer type definitions for AVR.">stdint.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="assert_8h.html" title="Run-time and build-time assertion support.">assert.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="include_2membag_8h.html" title="Memory bag allocator.">membag.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="arch_2avr8_2include_2arch_2string_8h.html" title="Standard string operations for AVR.">string.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="include_2gfx_2wtk_8h.html" title="Graphical Widget toolkit.">gfx/wtk.h</a>&gt;</span>
<a name="l00044"></a>00044 
<a name="l00054"></a><a class="code" href="group__gfx__wtk__slider.html#ga13b43e9bc769fa24f5bba5aa3218230c">00054</a> <span class="keyword">enum</span> <a class="code" href="group__gfx__wtk__slider.html#ga13b43e9bc769fa24f5bba5aa3218230c" title="Valid states for slider, relevant to pointer operations.">wtk_slider_state</a> {
<a name="l00056"></a><a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca3771aa540e1aa27229f5cba698d6d0a4">00056</a>         <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca3771aa540e1aa27229f5cba698d6d0a4" title="Normal state, no highlight or movement.">WTK_SLIDER_NORMAL</a>,
<a name="l00058"></a><a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca1ba13094aa12410278cb5b1d7d1440d2">00058</a>         <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca1ba13094aa12410278cb5b1d7d1440d2" title="Slider is pressed, highlighted and moving.">WTK_SLIDER_MOVING</a>,
<a name="l00059"></a>00059 };
<a name="l00060"></a>00060 
<a name="l00072"></a><a class="code" href="structwtk__slider.html">00072</a> <span class="keyword">struct </span><a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a> {
<a name="l00074"></a><a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9">00074</a>         <span class="keyword">struct </span><a class="code" href="structwin__window.html" title="Window control data.">win_window</a> *<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a>;
<a name="l00076"></a><a class="code" href="structwtk__slider.html#ac090fc4ee07d5b8fc5366df3d5a98a4a">00076</a>         <span class="keyword">struct </span><a class="code" href="structwin__point.html" title="Geometric type describing a point or vector on screen, relative or absolute.">win_point</a> <a class="code" href="structwtk__slider.html#ac090fc4ee07d5b8fc5366df3d5a98a4a" title="Slider position in relation to root window.">root_pos</a>;
<a name="l00078"></a><a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae">00078</a>         <span class="keyword">enum</span> <a class="code" href="group__gfx__wtk__slider.html#ga13b43e9bc769fa24f5bba5aa3218230c" title="Valid states for slider, relevant to pointer operations.">wtk_slider_state</a> <a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae" title="State of slider.">state</a>;
<a name="l00080"></a><a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c">00080</a>         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> <a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c" title="Maximum value of slider.">maximum</a>;
<a name="l00082"></a><a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2">00082</a>         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> <a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a>;
<a name="l00084"></a><a class="code" href="structwtk__slider.html#a0c49ab7368d094d38aa12d7a65b19885">00084</a>         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> <a class="code" href="structwtk__slider.html#a0c49ab7368d094d38aa12d7a65b19885" title="Position of slider knob.">position</a>;
<a name="l00086"></a><a class="code" href="structwtk__slider.html#a9d2ea7c2507dafc55e8414242fb0b3fe">00086</a>         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> <a class="code" href="structwtk__slider.html#a9d2ea7c2507dafc55e8414242fb0b3fe" title="Configuration of orientation and behavior.">option</a>;
<a name="l00088"></a><a class="code" href="structwtk__slider.html#af4ca3ea8a72aa6dd405334e8cd62d6b9">00088</a>         <a class="code" href="group__gfx__win.html#ga53f0ed533fce454af67e765764d7eb5f" title="Custom data, can be used as a data pointer or data depending on the application.">win_command_t</a> <a class="code" href="structwtk__slider.html#af4ca3ea8a72aa6dd405334e8cd62d6b9" title="Command to send. Must be non-zero if used.">command</a>;
<a name="l00089"></a>00089 };
<a name="l00090"></a>00090 
<a name="l00101"></a><a class="code" href="group__gfx__wtk__slider.html#ga7955edfc3a1e4fd85e155949189a9c35">00101</a> <span class="keyword">struct </span><a class="code" href="structwin__window.html" title="Window control data.">win_window</a> *<a class="code" href="group__gfx__wtk__slider.html#ga7955edfc3a1e4fd85e155949189a9c35" title="Get pointer to slider window.">wtk_slider_as_child</a>(<span class="keyword">struct</span> <a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a> *<a class="code" href="group__app__widget__group.html#ga26b0162371df25ecfcdeced2a2433d0f" title="Pointer to slider.">slider</a>)
<a name="l00102"></a>00102 {
<a name="l00103"></a>00103         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(slider);
<a name="l00104"></a>00104         <span class="keywordflow">return</span> slider-&gt;<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a>;
<a name="l00105"></a>00105 }
<a name="l00106"></a>00106 
<a name="l00117"></a><a class="code" href="group__gfx__wtk__slider.html#gaafdfff9e1566f2dbc867f0e089cf29de">00117</a> <span class="keywordtype">bool</span> <a class="code" href="group__gfx__wtk__slider.html#gaafdfff9e1566f2dbc867f0e089cf29de" title="Get slider status.">wtk_slider_is_moving</a>(<span class="keyword">struct</span> <a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a> <span class="keyword">const</span> *<a class="code" href="group__app__widget__group.html#ga26b0162371df25ecfcdeced2a2433d0f" title="Pointer to slider.">slider</a>)
<a name="l00118"></a>00118 {
<a name="l00119"></a>00119         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(slider);
<a name="l00120"></a>00120         <span class="keywordflow">return</span> slider-&gt;<a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae" title="State of slider.">state</a> == <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca1ba13094aa12410278cb5b1d7d1440d2" title="Slider is pressed, highlighted and moving.">WTK_SLIDER_MOVING</a>;
<a name="l00121"></a>00121 }
<a name="l00122"></a>00122 
<a name="l00132"></a><a class="code" href="group__gfx__wtk__slider.html#ga685ad61e500fe87c9a50b4353fc926f6">00132</a> <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> <a class="code" href="group__gfx__wtk__slider.html#ga685ad61e500fe87c9a50b4353fc926f6" title="Get slider value.">wtk_slider_get_value</a>(<span class="keyword">struct</span> <a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a> <span class="keyword">const</span> *<a class="code" href="group__app__widget__group.html#ga26b0162371df25ecfcdeced2a2433d0f" title="Pointer to slider.">slider</a>)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(slider);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136         <span class="keywordflow">if</span> (slider-&gt;<a class="code" href="structwtk__slider.html#a9d2ea7c2507dafc55e8414242fb0b3fe" title="Configuration of orientation and behavior.">option</a> &amp; <a class="code" href="group__gfx__wtk__slider__options.html#ga1b1590b78df6ab7cf3145d14803b6229" title="Slider value is inverted.">WTK_SLIDER_INVERT</a>) {
<a name="l00137"></a>00137                 <span class="keywordflow">return</span> slider-&gt;<a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c" title="Maximum value of slider.">maximum</a> - slider-&gt;<a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a>;
<a name="l00138"></a>00138         } <span class="keywordflow">else</span> {
<a name="l00139"></a>00139                 <span class="keywordflow">return</span> slider-&gt;<a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a>;
<a name="l00140"></a>00140         }
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 
<a name="l00155"></a><a class="code" href="group__gfx__wtk__slider.html#gafd0dd2b3104a869bdef646178d425e8e">00155</a> <span class="keywordtype">bool</span> <a class="code" href="group__gfx__wtk__slider.html#gafd0dd2b3104a869bdef646178d425e8e" title="Set new slider value.">wtk_slider_set_value</a>(<span class="keyword">struct</span> <a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a> *<a class="code" href="group__app__widget__group.html#ga26b0162371df25ecfcdeced2a2433d0f" title="Pointer to slider.">slider</a>, <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> value)
<a name="l00156"></a>00156 {
<a name="l00157"></a>00157         <span class="keyword">struct </span><a class="code" href="structwin__area.html" title="Geometric type describing an area on screen.">win_area</a> const   *area;
<a name="l00158"></a>00158         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a>                 length;
<a name="l00159"></a>00159         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a>                 option;
<a name="l00160"></a>00160 
<a name="l00161"></a>00161         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(slider);
<a name="l00162"></a>00162         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(value &lt;= slider-&gt;maximum);
<a name="l00163"></a>00163 
<a name="l00164"></a>00164         option = slider-&gt;<a class="code" href="structwtk__slider.html#a9d2ea7c2507dafc55e8414242fb0b3fe" title="Configuration of orientation and behavior.">option</a>;
<a name="l00165"></a>00165 
<a name="l00166"></a>00166         <span class="keywordflow">if</span> (option &amp; <a class="code" href="group__gfx__wtk__slider__options.html#ga1b1590b78df6ab7cf3145d14803b6229" title="Slider value is inverted.">WTK_SLIDER_INVERT</a>) {
<a name="l00167"></a>00167                 value = slider-&gt;<a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c" title="Maximum value of slider.">maximum</a> - value;
<a name="l00168"></a>00168         }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170         <span class="keywordflow">if</span> (slider-&gt;<a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a> != value) {
<a name="l00171"></a>00171                 slider-&gt;<a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a> = value;
<a name="l00172"></a>00172                 area = <a class="code" href="group__gfx__win.html#ga3b36b88b8811da7248eb23bc9af1c504" title="Get a pointer to the window area struct.">win_get_area</a>(slider-&gt;<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a>);
<a name="l00173"></a>00173 
<a name="l00174"></a>00174                 <span class="comment">/* Get length of slider from window.</span>
<a name="l00175"></a>00175 <span class="comment">                 * wtk_slider_create() asserts that this is an 8-bit value.</span>
<a name="l00176"></a>00176 <span class="comment">                 */</span>
<a name="l00177"></a>00177                 <span class="keywordflow">if</span> (option &amp; <a class="code" href="group__gfx__wtk__slider__options.html#gad8beb09fb293768c3ec0466683751e6b" title="Slider is vertically oriented.">WTK_SLIDER_VERTICAL</a>) {
<a name="l00178"></a>00178                         length = area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y;
<a name="l00179"></a>00179                 } <span class="keywordflow">else</span> {
<a name="l00180"></a>00180                         length = area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x;
<a name="l00181"></a>00181                 }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183                 length -= <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a>;
<a name="l00184"></a>00184                 slider-&gt;<a class="code" href="structwtk__slider.html#a0c49ab7368d094d38aa12d7a65b19885" title="Position of slider knob.">position</a> = <a class="code" href="group__gfx__wtk.html#ga04ff21a8882a2a0402c26cf3d1402afe" title="Rescale 8-bit value.">wtk_rescale_value</a>(value, slider-&gt;<a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c" title="Maximum value of slider.">maximum</a>,
<a name="l00185"></a>00185                                 length);
<a name="l00186"></a>00186 
<a name="l00187"></a>00187                 <a class="code" href="group__gfx__win.html#ga7f5e9dd7246c26ade8a7a3a764b3dc74" title="Redraw window and its contents, if visible.">win_redraw</a>(slider-&gt;<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a>);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00190"></a>00190         } <span class="keywordflow">else</span> {
<a name="l00191"></a>00191                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00192"></a>00192         }
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00213"></a><a class="code" href="group__gfx__wtk__slider.html#ga1c295ce3bf4681601693f370fe125919">00213</a> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="group__gfx__wtk__slider.html#ga1c295ce3bf4681601693f370fe125919" title="Slider event handler.">wtk_slider_handler</a>(<span class="keyword">struct</span> <a class="code" href="structwin__window.html" title="Window control data.">win_window</a> *win, <span class="keyword">enum</span> <a class="code" href="group__gfx__win.html#gafd48398368ba40935ca545757cb796a6" title="Valid event types sent to a window event handler.">win_event_type</a> type,
<a name="l00214"></a>00214                 <span class="keywordtype">void</span> <span class="keyword">const</span> *data)
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216         <span class="keyword">struct </span><a class="code" href="structwin__pointer__event.html" title="Event data for all pointer events, e.g. touch screen or mouse.">win_pointer_event</a> const  *event;
<a name="l00217"></a>00217         <span class="keyword">struct </span><a class="code" href="structwin__clip__region.html" title="Geometric type describing a clipping region, used when drawing windows.">win_clip_region</a> const    *clip;
<a name="l00218"></a>00218         <span class="keyword">struct </span><a class="code" href="structwin__command__event.html" title="Event data for command events, e.g. a button widget action command.">win_command_event</a>        command;
<a name="l00219"></a>00219         <span class="keyword">struct </span><a class="code" href="structwin__area.html" title="Geometric type describing an area on screen.">win_area</a> const           *area;
<a name="l00220"></a>00220         <span class="keyword">struct </span><a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a>               *<a class="code" href="group__app__widget__group.html#ga26b0162371df25ecfcdeced2a2433d0f" title="Pointer to slider.">slider</a>;
<a name="l00221"></a>00221         <span class="keyword">struct </span><a class="code" href="structwin__point.html" title="Geometric type describing a point or vector on screen, relative or absolute.">win_point</a>                origin;
<a name="l00222"></a>00222         <a class="code" href="group__gfx__gfx.html#ga3512fa493d2ad9c2192af24f6d3eff5c" title="Data type for color values native to the display.">gfx_color_t</a>                     knob_color;
<a name="l00223"></a>00223         <a class="code" href="group__gfx__gfx.html#ga32e82d1159c77b5fa73c8e5ffd962eba" title="Data type representing a coordinate on the screen.">gfx_coord_t</a>                     position;
<a name="l00224"></a>00224         <a class="code" href="group__gfx__gfx.html#ga32e82d1159c77b5fa73c8e5ffd962eba" title="Data type representing a coordinate on the screen.">gfx_coord_t</a>                     length;
<a name="l00225"></a>00225         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a>                         option;
<a name="l00226"></a>00226         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a>                         value;
<a name="l00227"></a>00227         <span class="keywordtype">bool</span>                            send_command;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229         slider = (<span class="keyword">struct </span><a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a> *)<a class="code" href="group__gfx__win.html#ga78b99e57a2493c4861f2d73863d12cf3" title="Get window custom data.">win_get_custom_data</a>(win);
<a name="l00230"></a>00230 
<a name="l00231"></a>00231         <span class="comment">// There should not be other windows in this widget.</span>
<a name="l00232"></a>00232         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(win == slider-&gt;<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a>);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234         <span class="keywordflow">switch</span> (type) {
<a name="l00235"></a>00235         <span class="keywordflow">case</span> <a class="code" href="group__gfx__win.html#ggafd48398368ba40935ca545757cb796a6ac6e863c463516b27f2d89eed008cacb6" title="Request to draw contents, after background.">WIN_EVENT_DRAW</a>:
<a name="l00236"></a>00236                 <span class="comment">/* For DRAW events, the data parameter points to the</span>
<a name="l00237"></a>00237 <span class="comment">                 * clipping region.</span>
<a name="l00238"></a>00238 <span class="comment">                 */</span>
<a name="l00239"></a>00239                 clip = (<span class="keyword">struct </span><a class="code" href="structwin__clip__region.html" title="Geometric type describing a clipping region, used when drawing windows.">win_clip_region</a> const *)data;
<a name="l00240"></a>00240                 area = <a class="code" href="group__gfx__win.html#ga3b36b88b8811da7248eb23bc9af1c504" title="Get a pointer to the window area struct.">win_get_area</a>(win);
<a name="l00241"></a>00241                 option = slider-&gt;<a class="code" href="structwtk__slider.html#a9d2ea7c2507dafc55e8414242fb0b3fe" title="Configuration of orientation and behavior.">option</a>;
<a name="l00242"></a>00242 
<a name="l00243"></a>00243                 <span class="keywordflow">if</span> (slider-&gt;<a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae" title="State of slider.">state</a> == <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca3771aa540e1aa27229f5cba698d6d0a4" title="Normal state, no highlight or movement.">WTK_SLIDER_NORMAL</a>) {
<a name="l00244"></a>00244                         knob_color = <a class="code" href="group__gfx__wtk__slider.html#ga7a581df4ec520950ee5ac63ff5db17f4" title="Color of the slider knob when normal.">WTK_SLIDER_KNOB_COLOR_NORMAL</a>;
<a name="l00245"></a>00245                 } <span class="keywordflow">else</span> {
<a name="l00246"></a>00246                         knob_color = <a class="code" href="group__gfx__wtk__slider.html#ga8f19ebea861c20aefbde0b76fe672055" title="Color of the slider knob when moving.">WTK_SLIDER_KNOB_COLOR_MOVING</a>;
<a name="l00247"></a>00247                 }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249                 <span class="comment">// Draw slider frame border.</span>
<a name="l00250"></a>00250                 <a class="code" href="group__gfx__gfx.html#gab42059725ca38dc3e876afcc86d00260" title="Draw an outline of a rectangle.">gfx_draw_rect</a>(clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.x,
<a name="l00251"></a>00251                                 clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.y,
<a name="l00252"></a>00252                                 area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x,
<a name="l00253"></a>00253                                 area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y, <a class="code" href="group__gfx__wtk__slider.html#gab7ca32ddb6183637ca2d1fdb9f26ac02" title="Color of all the slider&amp;#39;s borders.">WTK_SLIDER_BORDER_COLOR</a>);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255                 <span class="comment">// Draw slider frame background within frame.</span>
<a name="l00256"></a>00256                 <a class="code" href="group__gfx__gfx.html#gac466c148896f0b12a313294560e3c10c" title="Draw a filled rectangle.">gfx_draw_filled_rect</a>(clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.x + 1,
<a name="l00257"></a>00257                                 clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.y + 1,
<a name="l00258"></a>00258                                 area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x - 2,
<a name="l00259"></a>00259                                 area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y - 2, <a class="code" href="group__gfx__wtk__slider.html#ga3ac03c0cb02f775a3860b021eed92dd0" title="Color of the slider&amp;#39;s background.">WTK_SLIDER_BACKGROUND_COLOR</a>);
<a name="l00260"></a>00260 
<a name="l00261"></a>00261                 <span class="comment">// Draw the slider knob according to configured orientation.</span>
<a name="l00262"></a>00262                 <span class="keywordflow">if</span> (option &amp; <a class="code" href="group__gfx__wtk__slider__options.html#gad8beb09fb293768c3ec0466683751e6b" title="Slider is vertically oriented.">WTK_SLIDER_VERTICAL</a>) {
<a name="l00263"></a>00263                         <span class="comment">// Draw slider knob border.</span>
<a name="l00264"></a>00264                         <a class="code" href="group__gfx__gfx.html#gab42059725ca38dc3e876afcc86d00260" title="Draw an outline of a rectangle.">gfx_draw_rect</a>(clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.x,
<a name="l00265"></a>00265                                         clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.y + slider-&gt;<a class="code" href="structwtk__slider.html#a0c49ab7368d094d38aa12d7a65b19885" title="Position of slider knob.">position</a>,
<a name="l00266"></a>00266                                         area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x,
<a name="l00267"></a>00267                                         <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a>,
<a name="l00268"></a>00268                                         <a class="code" href="group__gfx__wtk__slider.html#gab7ca32ddb6183637ca2d1fdb9f26ac02" title="Color of all the slider&amp;#39;s borders.">WTK_SLIDER_BORDER_COLOR</a>);
<a name="l00269"></a>00269 
<a name="l00270"></a>00270                         <span class="comment">// Draw slider knob.</span>
<a name="l00271"></a>00271                         <a class="code" href="group__gfx__gfx.html#gac466c148896f0b12a313294560e3c10c" title="Draw a filled rectangle.">gfx_draw_filled_rect</a>(clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.x + 1,
<a name="l00272"></a>00272                                         clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.y + slider-&gt;<a class="code" href="structwtk__slider.html#a0c49ab7368d094d38aa12d7a65b19885" title="Position of slider knob.">position</a> + 1,
<a name="l00273"></a>00273                                         area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x - 2,
<a name="l00274"></a>00274                                         <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a> - 2, knob_color);
<a name="l00275"></a>00275                 } <span class="keywordflow">else</span> {
<a name="l00276"></a>00276                         <a class="code" href="group__gfx__gfx.html#gab42059725ca38dc3e876afcc86d00260" title="Draw an outline of a rectangle.">gfx_draw_rect</a>(clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.x + slider-&gt;<a class="code" href="structwtk__slider.html#a0c49ab7368d094d38aa12d7a65b19885" title="Position of slider knob.">position</a>,
<a name="l00277"></a>00277                                         clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.y,
<a name="l00278"></a>00278                                         <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a>,
<a name="l00279"></a>00279                                         area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y, <a class="code" href="group__gfx__wtk__slider.html#gab7ca32ddb6183637ca2d1fdb9f26ac02" title="Color of all the slider&amp;#39;s borders.">WTK_SLIDER_BORDER_COLOR</a>);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281                         <a class="code" href="group__gfx__gfx.html#gac466c148896f0b12a313294560e3c10c" title="Draw a filled rectangle.">gfx_draw_filled_rect</a>(clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.x + slider-&gt;<a class="code" href="structwtk__slider.html#a0c49ab7368d094d38aa12d7a65b19885" title="Position of slider knob.">position</a>
<a name="l00282"></a>00282                                         + 1,
<a name="l00283"></a>00283                                         clip-&gt;<a class="code" href="structwin__clip__region.html#a5989475e9092c659a032cb6d4dd99353" title="Absolute coordinates of top-left window corner.">origin</a>.y + 1,
<a name="l00284"></a>00284                                         <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a> - 2,
<a name="l00285"></a>00285                                         area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y - 2, knob_color);
<a name="l00286"></a>00286                 }
<a name="l00287"></a>00287 
<a name="l00288"></a>00288                 <span class="comment">/* Always accept DRAW events, as the return value is ignored</span>
<a name="l00289"></a>00289 <span class="comment">                 * anyway for that event type.</span>
<a name="l00290"></a>00290 <span class="comment">                 */</span>
<a name="l00291"></a>00291                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00292"></a>00292 
<a name="l00293"></a>00293 
<a name="l00294"></a>00294         <span class="keywordflow">case</span> <a class="code" href="group__gfx__win.html#ggafd48398368ba40935ca545757cb796a6a1e0c0b12cd9f4c453412c5a2437520ac" title="Pointer event, more details in the event itself.">WIN_EVENT_POINTER</a>:
<a name="l00295"></a>00295                 <span class="comment">/* For POINTER events, the data parameter points to the pointer</span>
<a name="l00296"></a>00296 <span class="comment">                 * event information.</span>
<a name="l00297"></a>00297 <span class="comment">                 */</span>
<a name="l00298"></a>00298                 <span class="keyword">event</span> = (<span class="keyword">struct </span><a class="code" href="structwin__pointer__event.html" title="Event data for all pointer events, e.g. touch screen or mouse.">win_pointer_event</a> const *)data;
<a name="l00299"></a>00299                 area = <a class="code" href="group__gfx__win.html#ga3b36b88b8811da7248eb23bc9af1c504" title="Get a pointer to the window area struct.">win_get_area</a>(win);
<a name="l00300"></a>00300                 option = slider-&gt;<a class="code" href="structwtk__slider.html#a9d2ea7c2507dafc55e8414242fb0b3fe" title="Configuration of orientation and behavior.">option</a>;
<a name="l00301"></a>00301                 send_command = <span class="keyword">false</span>;
<a name="l00302"></a>00302                 origin = slider-&gt;<a class="code" href="structwtk__slider.html#ac090fc4ee07d5b8fc5366df3d5a98a4a" title="Slider position in relation to root window.">root_pos</a>;
<a name="l00303"></a>00303 
<a name="l00304"></a>00304                 <span class="keywordflow">switch</span> (event-&gt;<a class="code" href="structwin__pointer__event.html#aaa4a37836e543dbc11329b0c2863fdba" title="Type of this event.">type</a>) {
<a name="l00305"></a>00305                 <span class="keywordflow">case</span> <a class="code" href="group__gfx__win.html#gga977ff672b3aea585f00cb10950e5aaf2accdf9dcd8cdb612477834cf3fbc47cf8" title="One or more buttons have been pressed somewhere.">WIN_POINTER_PRESS</a>:
<a name="l00306"></a>00306                         <span class="comment">/* Grab the pointer and redraw a highlighted slider.</span>
<a name="l00307"></a>00307 <span class="comment">                         * Slider value is not updated yet.</span>
<a name="l00308"></a>00308 <span class="comment">                         */</span>
<a name="l00309"></a>00309                         <span class="keywordflow">if</span> (slider-&gt;<a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae" title="State of slider.">state</a> == <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca3771aa540e1aa27229f5cba698d6d0a4" title="Normal state, no highlight or movement.">WTK_SLIDER_NORMAL</a>) {
<a name="l00310"></a>00310                                 slider-&gt;<a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae" title="State of slider.">state</a> = <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca1ba13094aa12410278cb5b1d7d1440d2" title="Slider is pressed, highlighted and moving.">WTK_SLIDER_MOVING</a>;
<a name="l00311"></a>00311                                 <a class="code" href="group__gfx__win.html#gafeab76a239174ba19edacbbf52a5861b" title="Set pointer focus window or NULL, i.e. override pointer event receiver.">win_grab_pointer</a>(win);
<a name="l00312"></a>00312                                 <a class="code" href="group__gfx__win.html#ga7f5e9dd7246c26ade8a7a3a764b3dc74" title="Redraw window and its contents, if visible.">win_redraw</a>(win);
<a name="l00313"></a>00313                         };
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 <span class="preprocessor">#if WTK_SLIDER_PARENT_MOVE_SUPPORT</span>
<a name="l00316"></a>00316 <span class="preprocessor"></span>                        <span class="comment">// Update root position.</span>
<a name="l00317"></a>00317                         <a class="code" href="group__gfx__win.html#gae2fb3daf5677ff55b4930a664cade66e" title="Compute window position on root window.">win_translate_win_to_root</a>(win, &amp;slider-&gt;<a class="code" href="structwtk__slider.html#ac090fc4ee07d5b8fc5366df3d5a98a4a" title="Slider position in relation to root window.">root_pos</a>);
<a name="l00318"></a>00318 <span class="preprocessor">#endif</span>
<a name="l00319"></a>00319 <span class="preprocessor"></span>                        <span class="keywordflow">break</span>;
<a name="l00320"></a>00320 
<a name="l00321"></a>00321                 <span class="keywordflow">case</span> <a class="code" href="group__gfx__win.html#gga977ff672b3aea585f00cb10950e5aaf2acf38ef7bba0b554929a29b4dabc76815" title="Pointer has moved, with or without buttons.">WIN_POINTER_MOVE</a>:
<a name="l00322"></a>00322                         <span class="comment">/* The slider is only updated when the pointer moves</span>
<a name="l00323"></a>00323 <span class="comment">                         * and the window was previously pressed. The pointer</span>
<a name="l00324"></a>00324 <span class="comment">                         * does not need to remain within the window to control</span>
<a name="l00325"></a>00325 <span class="comment">                         * the knob as only the position along the slider&#39;s</span>
<a name="l00326"></a>00326 <span class="comment">                         * direction of orientation is used.</span>
<a name="l00327"></a>00327 <span class="comment">                         */</span>
<a name="l00328"></a>00328                         <span class="keywordflow">if</span> (slider-&gt;<a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae" title="State of slider.">state</a> == <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca1ba13094aa12410278cb5b1d7d1440d2" title="Slider is pressed, highlighted and moving.">WTK_SLIDER_MOVING</a>) {
<a name="l00329"></a>00329                                 <span class="comment">/* Get the position of the pointer relative to</span>
<a name="l00330"></a>00330 <span class="comment">                                 * slider knob&#39;s origin, and the length of the</span>
<a name="l00331"></a>00331 <span class="comment">                                 * slider itself.</span>
<a name="l00332"></a>00332 <span class="comment">                                 */</span>
<a name="l00333"></a>00333                                 <span class="keywordflow">if</span> (option &amp; WTK_SLIDER_VERTICAL) {
<a name="l00334"></a>00334                                         position = <span class="keyword">event</span>-&gt;pos.y - origin.y;
<a name="l00335"></a>00335                                         length = area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y;
<a name="l00336"></a>00336                                 } <span class="keywordflow">else</span> {
<a name="l00337"></a>00337                                         position = <span class="keyword">event</span>-&gt;pos.x - origin.x;
<a name="l00338"></a>00338                                         length = area-&gt;<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x;
<a name="l00339"></a>00339                                 }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341                                 <span class="comment">// Subtract offsets due to slider knob size.</span>
<a name="l00342"></a>00342                                 position -= <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a> / 2;
<a name="l00343"></a>00343                                 length -= <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a>;
<a name="l00344"></a>00344 
<a name="l00345"></a>00345                                 <span class="comment">/* Bound the value if pointer is outside window.</span>
<a name="l00346"></a>00346 <span class="comment">                                 * Otherwise, compute the slider value from the</span>
<a name="l00347"></a>00347 <span class="comment">                                 * knob position.</span>
<a name="l00348"></a>00348 <span class="comment">                                 */</span>
<a name="l00349"></a>00349                                 <span class="keywordflow">if</span> (position &lt; 0) {
<a name="l00350"></a>00350                                         value = 0;
<a name="l00351"></a>00351                                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (position &gt; length) {
<a name="l00352"></a>00352                                         value = slider-&gt;<a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c" title="Maximum value of slider.">maximum</a>;
<a name="l00353"></a>00353                                 } <span class="keywordflow">else</span> {
<a name="l00354"></a>00354                                         value = <a class="code" href="group__gfx__wtk.html#ga04ff21a8882a2a0402c26cf3d1402afe" title="Rescale 8-bit value.">wtk_rescale_value</a>(position,
<a name="l00355"></a>00355                                                         length,
<a name="l00356"></a>00356                                                         slider-&gt;<a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c" title="Maximum value of slider.">maximum</a>);
<a name="l00357"></a>00357                                 }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359                                 <span class="comment">// Update slider only if this is a new value.</span>
<a name="l00360"></a>00360                                 <span class="keywordflow">if</span> (slider-&gt;<a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a> != value) {
<a name="l00361"></a>00361                                         slider-&gt;<a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a> = value;
<a name="l00362"></a>00362 
<a name="l00363"></a>00363                                         <span class="comment">/* Compute knob position from value to</span>
<a name="l00364"></a>00364 <span class="comment">                                         * get correct positioning.</span>
<a name="l00365"></a>00365 <span class="comment">                                         */</span>
<a name="l00366"></a>00366                                         slider-&gt;<a class="code" href="structwtk__slider.html#a0c49ab7368d094d38aa12d7a65b19885" title="Position of slider knob.">position</a> =
<a name="l00367"></a>00367                                                         <a class="code" href="group__gfx__wtk.html#ga04ff21a8882a2a0402c26cf3d1402afe" title="Rescale 8-bit value.">wtk_rescale_value</a>(value,
<a name="l00368"></a>00368                                                         slider-&gt;<a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c" title="Maximum value of slider.">maximum</a>,
<a name="l00369"></a>00369                                                         length);
<a name="l00370"></a>00370 
<a name="l00371"></a>00371                                         <span class="keywordflow">if</span> (option &amp; <a class="code" href="group__gfx__wtk__slider__options.html#ga9a1cffabd72104a7a3d44520096bd74d" title="Issue command event whenever slider value is updated.">WTK_SLIDER_CMD_MOVE</a>) {
<a name="l00372"></a>00372                                                 send_command = <span class="keyword">true</span>;
<a name="l00373"></a>00373                                         }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375                                         <a class="code" href="group__gfx__win.html#ga7f5e9dd7246c26ade8a7a3a764b3dc74" title="Redraw window and its contents, if visible.">win_redraw</a>(win);
<a name="l00376"></a>00376                                 }
<a name="l00377"></a>00377                         }
<a name="l00378"></a>00378                         <span class="keywordflow">break</span>;
<a name="l00379"></a>00379 
<a name="l00380"></a>00380                 <span class="keywordflow">case</span> <a class="code" href="group__gfx__win.html#gga977ff672b3aea585f00cb10950e5aaf2a5d9a8016905f31b1c7726370b2f7f0de" title="One or more buttons have been released somewhere.">WIN_POINTER_RELEASE</a>:
<a name="l00381"></a>00381                         <span class="comment">/* Release the pointer and redraw a normal slider.</span>
<a name="l00382"></a>00382 <span class="comment">                         * The slider&#39;s value is not updated. Hence, a pointer</span>
<a name="l00383"></a>00383 <span class="comment">                         * press directly followed by a release will leave the</span>
<a name="l00384"></a>00384 <span class="comment">                         * slider value unchanged.</span>
<a name="l00385"></a>00385 <span class="comment">                         */</span>
<a name="l00386"></a>00386                         <span class="keywordflow">if</span> (slider-&gt;<a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae" title="State of slider.">state</a> == <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca1ba13094aa12410278cb5b1d7d1440d2" title="Slider is pressed, highlighted and moving.">WTK_SLIDER_MOVING</a>) {
<a name="l00387"></a>00387                                 slider-&gt;<a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae" title="State of slider.">state</a> = <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca3771aa540e1aa27229f5cba698d6d0a4" title="Normal state, no highlight or movement.">WTK_SLIDER_NORMAL</a>;
<a name="l00388"></a>00388                                 <a class="code" href="group__gfx__win.html#gafeab76a239174ba19edacbbf52a5861b" title="Set pointer focus window or NULL, i.e. override pointer event receiver.">win_grab_pointer</a>(NULL);
<a name="l00389"></a>00389                                 <a class="code" href="group__gfx__win.html#ga7f5e9dd7246c26ade8a7a3a764b3dc74" title="Redraw window and its contents, if visible.">win_redraw</a>(win);
<a name="l00390"></a>00390 
<a name="l00391"></a>00391                                 <span class="keywordflow">if</span> (option &amp; <a class="code" href="group__gfx__wtk__slider__options.html#ga4e587f08b054a5edd2a559c98d25ac82" title="Issue command event whenever slider is released.">WTK_SLIDER_CMD_RELEASE</a>) {
<a name="l00392"></a>00392                                         send_command = <span class="keyword">true</span>;
<a name="l00393"></a>00393                                 }
<a name="l00394"></a>00394                         }
<a name="l00395"></a>00395                         <span class="keywordflow">break</span>;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397                 <span class="keywordflow">default</span>:
<a name="l00398"></a>00398                         <span class="keywordflow">break</span>;
<a name="l00399"></a>00399                 }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401                 <span class="comment">// Prepare and send command, if it was flagged.</span>
<a name="l00402"></a>00402                 <span class="keywordflow">if</span> (send_command) {
<a name="l00403"></a>00403                         command.<a class="code" href="structwin__command__event.html#aada18f35980f31de5efb4670b5559fe1" title="Window that sent the event, or NULL.">sender</a> = slider-&gt;<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a>;
<a name="l00404"></a>00404                         command.<a class="code" href="structwin__command__event.html#a1b5f3b4554fa387859c6ace80eed1a1e" title="Intended recipient of command.">recipient</a> = slider-&gt;<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a>;
<a name="l00405"></a>00405                         command.<a class="code" href="structwin__command__event.html#a1bfc7c36783d00b895f3d60f5581086c" title="Custom data, depending on command type.">data</a> = slider-&gt;<a class="code" href="structwtk__slider.html#af4ca3ea8a72aa6dd405334e8cd62d6b9" title="Command to send. Must be non-zero if used.">command</a>;
<a name="l00406"></a>00406                         <a class="code" href="group__gfx__win.html#ga345973b9a55038011d9fe5d024539173" title="Add a command event to the internal event queue.">win_queue_command_event</a>(&amp;command);
<a name="l00407"></a>00407                 }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409                 <span class="comment">/* Accept all POINTER events since all acitivity inside the</span>
<a name="l00410"></a>00410 <span class="comment">                 * widget window is relevant.</span>
<a name="l00411"></a>00411 <span class="comment">                 */</span>
<a name="l00412"></a>00412                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00413"></a>00413 
<a name="l00414"></a>00414         <span class="keywordflow">case</span> <a class="code" href="group__gfx__win.html#ggafd48398368ba40935ca545757cb796a6a4a13cc3406aa6b2ebb9e40a1fc111a64" title="Request to free all allocated memory.">WIN_EVENT_DESTROY</a>:
<a name="l00415"></a>00415                 <span class="comment">/* Memory allocated for windows will be automatically destroyed</span>
<a name="l00416"></a>00416 <span class="comment">                 * by the window system. We must destroy other allocations.</span>
<a name="l00417"></a>00417 <span class="comment">                 */</span>
<a name="l00418"></a>00418                 <a class="code" href="group__membag__group.html#ga48cbe39bcafbfff70f900aeca0748b27" title="Free previously allocated memory.">membag_free</a>(slider);
<a name="l00419"></a>00419 
<a name="l00420"></a>00420                 <span class="comment">/* Always accept DESTROY events, as the return value is ignored</span>
<a name="l00421"></a>00421 <span class="comment">                 * anyway for that event type.</span>
<a name="l00422"></a>00422 <span class="comment">                 */</span>
<a name="l00423"></a>00423                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425         <span class="keywordflow">default</span>:
<a name="l00426"></a>00426                 <span class="comment">// Reject unknown event types.</span>
<a name="l00427"></a>00427                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429 }
<a name="l00430"></a>00430 
<a name="l00466"></a><a class="code" href="group__gfx__wtk__slider.html#ga9e568e682198071b0ed1d0baba6d24d3">00466</a> <span class="keyword">struct </span><a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a> *<a class="code" href="group__gfx__wtk__slider.html#ga9e568e682198071b0ed1d0baba6d24d3" title="Create a new slider widget.">wtk_slider_create</a>(<span class="keyword">struct</span> <a class="code" href="structwin__window.html" title="Window control data.">win_window</a> *parent,
<a name="l00467"></a>00467                 <span class="keyword">struct</span> <a class="code" href="structwin__area.html" title="Geometric type describing an area on screen.">win_area</a> <span class="keyword">const</span> *area, <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> <a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c" title="Maximum value of slider.">maximum</a>, <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> <a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a>,
<a name="l00468"></a>00468                 <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a> <a class="code" href="structwtk__slider.html#a9d2ea7c2507dafc55e8414242fb0b3fe" title="Configuration of orientation and behavior.">option</a>, <a class="code" href="group__gfx__win.html#ga53f0ed533fce454af67e765764d7eb5f" title="Custom data, can be used as a data pointer or data depending on the application.">win_command_t</a> <a class="code" href="structwtk__slider.html#af4ca3ea8a72aa6dd405334e8cd62d6b9" title="Command to send. Must be non-zero if used.">command</a>)
<a name="l00469"></a>00469 {
<a name="l00470"></a>00470         <span class="keyword">struct </span><a class="code" href="structwin__attributes.html" title="Window attribute data.">win_attributes</a>   attr;
<a name="l00471"></a>00471         <span class="keyword">struct </span><a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a>       *<a class="code" href="group__app__widget__group.html#ga26b0162371df25ecfcdeced2a2433d0f" title="Pointer to slider.">slider</a>;
<a name="l00472"></a>00472         <a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a>                 length;
<a name="l00473"></a>00473 
<a name="l00474"></a>00474         <span class="comment">// Do sanity check on parameters.</span>
<a name="l00475"></a>00475         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(maximum &gt; 0);
<a name="l00476"></a>00476         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(area);
<a name="l00477"></a>00477         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(parent);
<a name="l00478"></a>00478 
<a name="l00479"></a>00479         <span class="comment">// Allocate memory for the control data.</span>
<a name="l00480"></a>00480         slider = <a class="code" href="group__membag__group.html#gad2210e38b675715afcd6e1f154ba2ecd" title="Allocate memory.">membag_alloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structwtk__slider.html" title="Slider control struct.">wtk_slider</a>));
<a name="l00481"></a>00481         <span class="keywordflow">if</span> (!slider) {
<a name="l00482"></a>00482                 <span class="keywordflow">goto</span> outofmem_slider;
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485         <span class="comment">// Initialize the slider data.</span>
<a name="l00486"></a>00486         slider-&gt;<a class="code" href="structwtk__slider.html#a61273518ac88688a95a26493073be1ae" title="State of slider.">state</a> = <a class="code" href="group__gfx__wtk__slider.html#gga13b43e9bc769fa24f5bba5aa3218230ca3771aa540e1aa27229f5cba698d6d0a4" title="Normal state, no highlight or movement.">WTK_SLIDER_NORMAL</a>;
<a name="l00487"></a>00487         slider-&gt;<a class="code" href="structwtk__slider.html#ad8375516174460cef2ac13e3096aed4c" title="Maximum value of slider.">maximum</a> = maximum;
<a name="l00488"></a>00488         slider-&gt;<a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a> = value;
<a name="l00489"></a>00489         slider-&gt;<a class="code" href="structwtk__slider.html#a9d2ea7c2507dafc55e8414242fb0b3fe" title="Configuration of orientation and behavior.">option</a> = option;
<a name="l00490"></a>00490 
<a name="l00491"></a>00491         <span class="comment">// Invert the initial value if slider is inverted.</span>
<a name="l00492"></a>00492         <span class="keywordflow">if</span> (option &amp; <a class="code" href="group__gfx__wtk__slider__options.html#ga1b1590b78df6ab7cf3145d14803b6229" title="Slider value is inverted.">WTK_SLIDER_INVERT</a>) {
<a name="l00493"></a>00493                 value = maximum - value;
<a name="l00494"></a>00494         }
<a name="l00495"></a>00495 
<a name="l00496"></a>00496         slider-&gt;<a class="code" href="structwtk__slider.html#a2250e0319bc41f5b26acef3fe6f480a2" title="Value of slider.">value</a> = value;
<a name="l00497"></a>00497 
<a name="l00498"></a>00498         <span class="comment">// Enforce a non-zero command value, if these are enabled.</span>
<a name="l00499"></a>00499         <span class="keywordflow">if</span> (option &amp; (<a class="code" href="group__gfx__wtk__slider__options.html#ga9a1cffabd72104a7a3d44520096bd74d" title="Issue command event whenever slider value is updated.">WTK_SLIDER_CMD_MOVE</a> | <a class="code" href="group__gfx__wtk__slider__options.html#ga4e587f08b054a5edd2a559c98d25ac82" title="Issue command event whenever slider is released.">WTK_SLIDER_CMD_RELEASE</a>)) {
<a name="l00500"></a>00500                 <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(command &gt; 0);
<a name="l00501"></a>00501                 slider-&gt;<a class="code" href="structwtk__slider.html#af4ca3ea8a72aa6dd405334e8cd62d6b9" title="Command to send. Must be non-zero if used.">command</a> = command;
<a name="l00502"></a>00502         }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504         <span class="comment">// Set up event handling for the widget window.</span>
<a name="l00505"></a>00505         attr.<a class="code" href="structwin__attributes.html#a1f7233ed770b597a93a5e1dd3c1917b8" title="Event handler callback, or NULL.">event_handler</a> = <a class="code" href="group__gfx__wtk__slider.html#ga1c295ce3bf4681601693f370fe125919" title="Slider event handler.">wtk_slider_handler</a>;
<a name="l00506"></a>00506         attr.<a class="code" href="structwin__attributes.html#ae9ae6ae18bc42bfeccb37a6fa5a826c5" title="Custom window data, e.g. link to associated widget.">custom</a> = slider;
<a name="l00507"></a>00507 
<a name="l00508"></a>00508         <span class="comment">// Do a sanity check of the specified window area parameters.</span>
<a name="l00509"></a>00509         attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a> = *area;
<a name="l00510"></a>00510         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x &gt; 0);
<a name="l00511"></a>00511         <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y &gt; 0);
<a name="l00512"></a>00512 
<a name="l00513"></a>00513         <span class="keywordflow">if</span> (option &amp; <a class="code" href="group__gfx__wtk__slider__options.html#gad8beb09fb293768c3ec0466683751e6b" title="Slider is vertically oriented.">WTK_SLIDER_VERTICAL</a>) {
<a name="l00514"></a>00514                 <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x &gt; 3);
<a name="l00515"></a>00515                 <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x &lt;= (<a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a>) ~ 0);
<a name="l00516"></a>00516                 <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y &gt; <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a>);
<a name="l00517"></a>00517                 length = attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y;
<a name="l00518"></a>00518         } <span class="keywordflow">else</span> {
<a name="l00519"></a>00519                 <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x &gt; <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a>);
<a name="l00520"></a>00520                 <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y &lt;= (<a class="code" href="group__stdint__group.html#gae1affc9ca37cfb624959c866a73f83c2" title="8-bit unsigned integer">uint8_t</a>) ~ 0);
<a name="l00521"></a>00521                 <a class="code" href="group__assert__group.html#gacdcc5aaebf3f273c1762f24a6ece2e5e" title="Assert that condition is true at run time.">assert</a>(attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.y &gt; 3);
<a name="l00522"></a>00522                 length = attr.<a class="code" href="structwin__attributes.html#a37c5f9ad4e8f35c8817cdccd321cb4a7" title="Position and size of window, relative to parent.">area</a>.<a class="code" href="structwin__area.html#afb961948c18ea282b2c4ea2d06542540" title="Width and height of area.">size</a>.x;
<a name="l00523"></a>00523         }
<a name="l00524"></a>00524 
<a name="l00525"></a>00525         <span class="comment">// Set slider knob position according to initial value.</span>
<a name="l00526"></a>00526         length -= <a class="code" href="group__gfx__wtk__slider.html#ga04fa0bbb960ca62d282506edc390bf2b" title="Width of the slider knob, including borders, in pixels.">WTK_SLIDER_KNOB_WIDTH</a>;
<a name="l00527"></a>00527         slider-&gt;<a class="code" href="structwtk__slider.html#a0c49ab7368d094d38aa12d7a65b19885" title="Position of slider knob.">position</a> = <a class="code" href="group__gfx__wtk.html#ga04ff21a8882a2a0402c26cf3d1402afe" title="Rescale 8-bit value.">wtk_rescale_value</a>(value, maximum, length);
<a name="l00528"></a>00528 
<a name="l00529"></a>00529         <span class="comment">/* All drawing is done in wtk_slider_handler() to reduce overhead.</span>
<a name="l00530"></a>00530 <span class="comment">         * Slider has no transparent areas, so parent does not need redrawing.</span>
<a name="l00531"></a>00531 <span class="comment">         */</span>
<a name="l00532"></a>00532         attr.<a class="code" href="structwin__attributes.html#ab3aaadedb6a8197cbd119cc7bb54ca64" title="Window background.">background</a> = NULL;
<a name="l00533"></a>00533         attr.<a class="code" href="structwin__attributes.html#a85bccce89013dbda4173a80d27dd9f90" title="Window behavior flags.">behavior</a> = 0;
<a name="l00534"></a>00534 
<a name="l00535"></a>00535         <span class="comment">// Create the widget window.</span>
<a name="l00536"></a>00536         slider-&gt;<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a> = <a class="code" href="group__gfx__win.html#ga2fef2c618144f46b67fb95ae138131b5" title="Create a window and return its pointer. Use win_destroy() to free memory.">win_create</a>(parent, &amp;attr);
<a name="l00537"></a>00537         <span class="keywordflow">if</span> (!slider-&gt;<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a>) {
<a name="l00538"></a>00538                 <span class="keywordflow">goto</span> outofmem_container;
<a name="l00539"></a>00539         }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541         <span class="comment">// Store absolute position</span>
<a name="l00542"></a>00542         <a class="code" href="group__gfx__win.html#gae2fb3daf5677ff55b4930a664cade66e" title="Compute window position on root window.">win_translate_win_to_root</a>(slider-&gt;<a class="code" href="structwtk__slider.html#a74a60445cb6ca4a84d6f379a37c322f9" title="Container window of slider.">container</a>, &amp;slider-&gt;<a class="code" href="structwtk__slider.html#ac090fc4ee07d5b8fc5366df3d5a98a4a" title="Slider position in relation to root window.">root_pos</a>);
<a name="l00543"></a>00543         <span class="keywordflow">return</span> slider;
<a name="l00544"></a>00544 
<a name="l00545"></a>00545 outofmem_container:
<a name="l00546"></a>00546         <a class="code" href="group__membag__group.html#ga48cbe39bcafbfff70f900aeca0748b27" title="Free previously allocated memory.">membag_free</a>(slider);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548 outofmem_slider:
<a name="l00549"></a>00549         <span class="keywordflow">return</span> NULL;
<a name="l00550"></a>00550 }
<a name="l00551"></a>00551 
</pre></div></div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Apr 29 15:18:21 2010 for display-training by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
