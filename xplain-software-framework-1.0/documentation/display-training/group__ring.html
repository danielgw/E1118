<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>display-training: Generic Ring Buffer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Generic Ring Buffer</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structring__head.html">ring_head</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Ring buffer management data.  <a href="structring__head.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga3b241b6bb24eab550479f89e4395a0a6">ring_get_head</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring, unsigned int ring_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the offset of the next unused entry in the buffer.  <a href="#ga3b241b6bb24eab550479f89e4395a0a6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gaaea07d76f6b2c875d6491b0be279db50">ring_get_tail</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring, unsigned int ring_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the offset of the first used entry in the buffer.  <a href="#gaaea07d76f6b2c875d6491b0be279db50"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gae845ed17131f966c669bf7053a7ddc5d">ring_entries_used</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the number of used entries in the buffer.  <a href="#gae845ed17131f966c669bf7053a7ddc5d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga4206606bf7e05bbc7031fe0579af204e">ring_entries_used_before_end</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring, unsigned int ring_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the number of used entries in the buffer before it wraps.  <a href="#ga4206606bf7e05bbc7031fe0579af204e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga6ea29d8440ab9399d4455a6928f6510c">ring_entries_unused</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring, unsigned int ring_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the number of unused entries in the buffer.  <a href="#ga6ea29d8440ab9399d4455a6928f6510c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gaf34ffcb46a4a88f24f0788cdfd013f85">ring_entries_unused_before_end</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring, unsigned int ring_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the number of unused entries in the buffer before it wraps.  <a href="#gaf34ffcb46a4a88f24f0788cdfd013f85"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga199c74a2198884bb2cc7d7575f23c7fc">ring_is_empty</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Test if the ring buffer is empty.  <a href="#ga199c74a2198884bb2cc7d7575f23c7fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga087b63a68b84f33b33a902af537292d6">ring_is_full</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring, unsigned int ring_size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Test if the ring buffer is full.  <a href="#ga087b63a68b84f33b33a902af537292d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga58b401f48944da61bf886423735d2772">ring_insert_entries</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring, unsigned int nr_entries)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Insert entries into the ring buffer.  <a href="#ga58b401f48944da61bf886423735d2772"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#ga46715f9e99bf31980e8a7ee112f412ac">ring_extract_entries</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring, unsigned int nr_entries)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract entries from the ring buffer.  <a href="#ga46715f9e99bf31980e8a7ee112f412ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ring.html#gab3fa5cba35877d516e55ecf01ad1990e">ring_reset</a> (struct <a class="el" href="structring__head.html">ring_head</a> *ring)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset the ring buffer.  <a href="#gab3fa5cba35877d516e55ecf01ad1990e"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This is a generic, lockless ring buffer abstration. Generic because it does not care about what kind of data is stored in the buffer, and lockless because the producer and consumer states are tracked separately. Therefore, the producer and consumer do not require protection from each other even if they may run in different contexts.</p>
<p>Note however that if there are multiple producers or multiple consumers running from different contexts, it may be necessary to protect multiple clients on the same side from each other by, for example, disabling interrupts.</p>
<p>The <em>head</em> of the buffer indicates the current <em>producer</em> state, i.e. the index at which the next produced object will be placed. The <em>tail</em> of the buffer indicates the current <em>consumer</em> state, i.e. the index of the oldest object which hasn't been consumed yet. If the producer and consumer may run from different contexts (i.e. one from an interrupt handler and the other from a workqueue), the caller must ensure that the object in the underlying buffer is not accessed after the head or tail has been updated. Both <a class="el" href="group__ring.html#ga46715f9e99bf31980e8a7ee112f412ac" title="Extract entries from the ring buffer.">ring_extract_entries()</a> and <a class="el" href="group__ring.html#ga58b401f48944da61bf886423735d2772" title="Insert entries into the ring buffer.">ring_insert_entries()</a> include an optimization barrier to ensure that the compiler does not break this by reordering the data accesses.</p>
<h2><a class="anchor" id="ring-restrictions">
Ring Buffer Restrictions</a></h2>
<p>In order to keep the ring buffer implementation efficient, there are a few restrictions that must be observed by the user:</p>
<ul>
<li>The ring buffer size must be a power of two. This is because the AND operator is used to wrap around when reaching the end of the buffer, rather than the much more expensive modulo operator.</li>
<li>The ring buffer size must not exceed half the maximum value of an unsigned int variable. If the entire range of unsigned int is used, there's no way to distinguish a completely filled buffer from an empty buffer. </li>
</ul>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga6ea29d8440ab9399d4455a6928f6510c"></a><!-- doxytag: member="ring.h::ring_entries_unused" ref="ga6ea29d8440ab9399d4455a6928f6510c" args="(struct ring_head *ring, unsigned int ring_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int ring_entries_unused </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>ring_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the number of unused entries in the buffer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ring_size</em>&nbsp;</td><td>The total number of entries in the ring buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of entries which can be inserted before the buffer is full. </dd></dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00219">219</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="ring_8h_source.html#l00182">ring_entries_used()</a>.</p>

<p>Referenced by <a class="el" href="stream_8h_source.html#l00161">stream_buf_unused()</a>.</p>

</div>
</div>
<a class="anchor" id="gaf34ffcb46a4a88f24f0788cdfd013f85"></a><!-- doxytag: member="ring.h::ring_entries_unused_before_end" ref="gaf34ffcb46a4a88f24f0788cdfd013f85" args="(struct ring_head *ring, unsigned int ring_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int ring_entries_unused_before_end </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>ring_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the number of unused entries in the buffer before it wraps. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ring_size</em>&nbsp;</td><td>The total number of entries in the ring buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of entries which can be inserted before the buffer is full or wraps around to the beginning. </dd></dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00235">235</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="ring_8h_source.html#l00105">ring_head::head</a>, and <a class="el" href="ring_8h_source.html#l00107">ring_head::tail</a>.</p>

<p>Referenced by <a class="el" href="stream_8h_source.html#l00173">stream_buf_unused_before_end()</a>.</p>

</div>
</div>
<a class="anchor" id="gae845ed17131f966c669bf7053a7ddc5d"></a><!-- doxytag: member="ring.h::ring_entries_used" ref="gae845ed17131f966c669bf7053a7ddc5d" args="(struct ring_head *ring)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int ring_entries_used </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the number of used entries in the buffer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of entries which can be extracted before the buffer is empty. </dd></dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00182">182</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="ring_8h_source.html#l00105">ring_head::head</a>, and <a class="el" href="ring_8h_source.html#l00107">ring_head::tail</a>.</p>

<p>Referenced by <a class="el" href="ring_8h_source.html#l00219">ring_entries_unused()</a>, <a class="el" href="ring_8h_source.html#l00271">ring_is_full()</a>, and <a class="el" href="stream_8h_source.html#l00167">stream_buf_used()</a>.</p>

</div>
</div>
<a class="anchor" id="ga4206606bf7e05bbc7031fe0579af204e"></a><!-- doxytag: member="ring.h::ring_entries_used_before_end" ref="ga4206606bf7e05bbc7031fe0579af204e" args="(struct ring_head *ring, unsigned int ring_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int ring_entries_used_before_end </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>ring_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the number of used entries in the buffer before it wraps. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ring_size</em>&nbsp;</td><td>The total number of entries in the ring buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of entries which can be extracted before the buffer is empty or wraps around to the beginning. </dd></dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00196">196</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="ring_8h_source.html#l00105">ring_head::head</a>, and <a class="el" href="ring_8h_source.html#l00107">ring_head::tail</a>.</p>

<p>Referenced by <a class="el" href="stream_8h_source.html#l00183">stream_buf_used_before_end()</a>.</p>

</div>
</div>
<a class="anchor" id="ga46715f9e99bf31980e8a7ee112f412ac"></a><!-- doxytag: member="ring.h::ring_extract_entries" ref="ga46715f9e99bf31980e8a7ee112f412ac" args="(struct ring_head *ring, unsigned int nr_entries)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ring_extract_entries </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>nr_entries</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Extract entries from the ring buffer. </p>
<p>Adjust the buffer tail to account for entries being extracted from the buffer. Normally, this should be called after the actual buffer contents have been read; the barrier ensures that the compiler doesn't move any buffer accesses after updating the tail.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nr_entries</em>&nbsp;</td><td>The number of entries to extract </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00306">306</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="compiler_8h_source.html#l00246">barrier</a>, and <a class="el" href="ring_8h_source.html#l00107">ring_head::tail</a>.</p>

<p>Referenced by <a class="el" href="stream_8h_source.html#l00225">stream_buf_extract_char()</a>.</p>

</div>
</div>
<a class="anchor" id="ga3b241b6bb24eab550479f89e4395a0a6"></a><!-- doxytag: member="ring.h::ring_get_head" ref="ga3b241b6bb24eab550479f89e4395a0a6" args="(struct ring_head *ring, unsigned int ring_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned long ring_get_head </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>ring_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the offset of the next unused entry in the buffer. </p>
<p>Note that the value returned by this function is only meaningful if there actually are any unused entries in the buffer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ring_size</em>&nbsp;</td><td>The total number of entries in the ring buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The offset into the buffer of the next unused entry. </dd></dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00147">147</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="ring_8h_source.html#l00105">ring_head::head</a>.</p>

<p>Referenced by <a class="el" href="stream_8h_source.html#l00193">stream_buf_head()</a>.</p>

</div>
</div>
<a class="anchor" id="gaaea07d76f6b2c875d6491b0be279db50"></a><!-- doxytag: member="ring.h::ring_get_tail" ref="gaaea07d76f6b2c875d6491b0be279db50" args="(struct ring_head *ring, unsigned int ring_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned long ring_get_tail </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>ring_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the offset of the first used entry in the buffer. </p>
<p>Note that the value returned by this function is only meaningful if there actually are any used entries in the buffer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ring_size</em>&nbsp;</td><td>The total number of entries in the ring buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The offset into the buffer of the first used entry. </dd></dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00166">166</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="ring_8h_source.html#l00107">ring_head::tail</a>.</p>

<p>Referenced by <a class="el" href="stream_8h_source.html#l00202">stream_buf_tail()</a>.</p>

</div>
</div>
<a class="anchor" id="ga58b401f48944da61bf886423735d2772"></a><!-- doxytag: member="ring.h::ring_insert_entries" ref="ga58b401f48944da61bf886423735d2772" args="(struct ring_head *ring, unsigned int nr_entries)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ring_insert_entries </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>nr_entries</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Insert entries into the ring buffer. </p>
<p>Adjust the buffer head to account for entries being inserted into the buffer. Normally, this should be called after the actual buffer contents have been updated; the barrier ensures that the compiler doesn't move any buffer accesses after updating the head.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nr_entries</em>&nbsp;</td><td>The number of entries to insert </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00288">288</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="compiler_8h_source.html#l00246">barrier</a>, and <a class="el" href="ring_8h_source.html#l00105">ring_head::head</a>.</p>

<p>Referenced by <a class="el" href="stream_8h_source.html#l00211">stream_buf_insert_char()</a>, and <a class="el" href="stream__core_8c_source.html#l00115">stream_priv_write()</a>.</p>

</div>
</div>
<a class="anchor" id="ga199c74a2198884bb2cc7d7575f23c7fc"></a><!-- doxytag: member="ring.h::ring_is_empty" ref="ga199c74a2198884bb2cc7d7575f23c7fc" args="(struct ring_head *ring)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool ring_is_empty </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Test if the ring buffer is empty. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>There are no used entries in the buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>There is at least one used entry in the buffer. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00257">257</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="ring_8h_source.html#l00105">ring_head::head</a>, and <a class="el" href="ring_8h_source.html#l00107">ring_head::tail</a>.</p>

<p>Referenced by <a class="el" href="stream_8h_source.html#l00149">stream_buf_has_data()</a>.</p>

</div>
</div>
<a class="anchor" id="ga087b63a68b84f33b33a902af537292d6"></a><!-- doxytag: member="ring.h::ring_is_full" ref="ga087b63a68b84f33b33a902af537292d6" args="(struct ring_head *ring, unsigned int ring_size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool ring_is_full </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>ring_size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Test if the ring buffer is full. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ring_size</em>&nbsp;</td><td>The total number of entries in the ring buffer</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>The ring buffer is full </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>There is room for at least one more entry in the buffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00271">271</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="ring_8h_source.html#l00182">ring_entries_used()</a>.</p>

<p>Referenced by <a class="el" href="stream_8h_source.html#l00155">stream_buf_is_full()</a>.</p>

</div>
</div>
<a class="anchor" id="gab3fa5cba35877d516e55ecf01ad1990e"></a><!-- doxytag: member="ring.h::ring_reset" ref="gab3fa5cba35877d516e55ecf01ad1990e" args="(struct ring_head *ring)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void ring_reset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structring__head.html">ring_head</a> *&nbsp;</td>
          <td class="paramname"> <em>ring</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reset the ring buffer. </p>
<p>This will mark the ring buffer as empty, and move both head and tail to the beginning of the buffer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ring</em>&nbsp;</td><td>The ring buffer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ring_8h_source.html#l00321">321</a> of file <a class="el" href="ring_8h_source.html">ring.h</a>.</p>

<p>References <a class="el" href="ring_8h_source.html#l00105">ring_head::head</a>, and <a class="el" href="ring_8h_source.html#l00107">ring_head::tail</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Apr 29 15:18:23 2010 for display-training by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
